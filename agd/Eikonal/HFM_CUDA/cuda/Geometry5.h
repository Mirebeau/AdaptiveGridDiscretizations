#pragma once
// Copyright 2020 Jean-Marie Mirebeau, University Paris-Sud, CNRS, University Paris-Saclay
// Distributed WITHOUT ANY WARRANTY. Licensed under the Apache License, Version 2.0, see http://www.apache.org/licenses/LICENSE-2.0


#include "TypeTraits.h"
const Int ndim=5;
#include "Geometry_.h"
#include "Inverse_.h"
#include "NetworkSort.h"

#define CUDA_DEVICE // Do not include <math.h>, and do not use exit(1)
#ifndef LINPROG_DIMENSION_MAX 
#define LINPROG_DIMENSION_MAX 5 // Use a non-recursive linprog
#endif
#include "LinProg/Siedel_Hohmeyer_LinProg.h"

namespace Voronoi {

/** This code is adapted from the c++ code in the CPU HFM library*/
namespace dim_symdim {
	const Int ndim=symdim;
	#include "Geometry_.h"
}

struct SimplexStateT {
	Scalar m[symdim];
	Scalar a[ndim][ndim];
	Int vertex;
	Scalar objective;
};

/** This code is adapted from the c++ code in the CPU HFM library*/

// We implement below Voronoi's reduction of four dimensional positive definite matrices.
const Int kktdim=20; // Number of support vectors in Voronoi's decomposition
typedef char small; // Small type to avoid overusing memory
typedef unsigned char uchar;
const Int nvertex = 3;
const Scalar vertex_[nvertex][symdim] = { // The three five dimensional perfect forms
{2,1,2,1,1,2,1,1,1,2,0,1,1,1,2},
{2,1,2,1,1,2,1,1,1,2,1,1,1,1,2},
{2,0.5,2,0.5,0.5,2,-1,-1,-1,2,-1,-1,-1,0.5,2}
};

const Int nneigh[3] = {400,symdim,symdim}; // Number of neighbors of the perfect forms. 

const small neigh_vertex0[400] = { // The type of each neighbor as a perfect form
0,0,2,0,0,0,0,1,2,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,2,2,2,2,1,0,2,2,2,1,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,2,2,0,0,0,0,
1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,
0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,
0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,
0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,1,0,0,0,1,0,0,0,0,0,0,0,0,
0,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,2,
2,2,2,2,2,2,2,2,2,2,2,2,2,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,2,2,0,0,0,
0,0,0,0,0,0,0,1,0,0,0,0,2,2,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,1,0,0,0,0,0,0,0,1,0,2,2,2,0,0,0,0,2,0,0,0,0,1,0,0,0,0,1,0,0,0,0,
0,0,1,0,0,0,0,2,2,2,0,0,0,0,0,0,1,0,0,0,0,1,0,0,2,2,2,0,0,0,0,0,0,
1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
};
// The coordinate change from each neighbor to the corresponding perfect form
/*const small neigh_chg0[400][ndim*ndim] = { 
{1,1,0,0,0,-1,0,0,0,0,0,-1,1,0,0,0,0,0,1,0,1,1,0,0,1},{1,0,0,0,0,0,1,0,0,0,-1,0,-1,0,0,0,0,0,1,0,1,0,1,0,1},{0,-1,0,0,0,1,0,1,0,0,1,0,0,1,0,1,0,0,0,0,1,0,1,1,1},{1,0,0,0,0,-1,-1,0,0,0,0,0,1,0,0,0,0,0,1,0,1,1,0,0,1},{1,1,0,0,0,-1,0,0,0,0,0,0,1,0,0,0,-1,0,1,0,1,1,0,0,1},{-1,0,0,0,0,0,-1,0,0,0,0,0,-1,0,0,1,0,0,1,0,0,1,1,0,1},{1,1,1,0,0,-1,0,0,0,0,0,-1,0,0,0,0,0,-1,1,0,1,1,1,0,1},{1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1},{-1,0,0,0,0,0,0,1,0,0,0,0,0,1,0,-1,-1,0,0,0,0,1,1,1,1},{1,2,0,1,0,-1,-1,0,0,0,-1,-1,-1,-1,0,0,-1,0,0,0,1,2,1,1,1},{-1,0,0,0,0,0,-1,0,0,0,1,1,1,0,0,1,1,0,1,0,-1,0,0,0,1},{1,1,0,1,0,-1,-1,0,0,0,-1,-1,-1,-1,0,0,-1,0,0,0,1,2,1,1,1},{-1,-1,0,0,0,0,-1,0,0,0,1,1,1,0,0,1,1,0,1,0,-1,0,0,0,1},{1,1,0,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1,0,0,0,1,0,0,1},{1,0,0,0,0,-1,-1,0,0,0,0,0,1,0,0,0,1,0,1,0,1,1,0,0,1},{-1,0,0,0,0,0,-1,0,0,0,0,0,-1,0,0,1,1,0,1,0,0,1,1,0,1},{-1,0,-1,0,0,1,1,0,0,0,0,0,1,-1,0,0,-1,0,0,0,0,1,0,1,1},{1,0,0,0,0,0,1,0,0,0,-1,-1,-1,0,0,0,0,0,1,0,1,1,1,0,1},
{1,0,0,0,0,-1,-1,0,0,0,0,1,1,0,0,0,0,0,1,0,1,1,0,0,1},{1,1,0,0,0,-1,0,0,0,0,0,0,1,0,0,0,0,0,1,0,1,1,0,0,1},{-1,-1,-1,0,0,1,0,0,0,0,0,1,0,0,0,1,1,1,1,0,-1,0,0,0,1},{-1,0,0,0,0,0,-1,0,0,0,1,1,1,0,0,1,0,0,1,0,-1,1,0,0,1},{1,1,0,1,0,-1,-1,0,0,0,-1,0,-1,-1,0,0,-1,0,0,0,1,2,1,1,1},{-1,0,0,0,0,0,-1,0,0,0,1,0,1,0,0,1,1,0,1,0,-1,1,0,0,1},{1,1,0,0,0,0,1,0,0,0,1,1,1,0,0,1,2,1,1,1,1,1,0,0,-1},{-1,-1,0,0,0,0,-1,0,0,0,0,0,1,0,0,0,0,1,1,1,0,-1,0,0,-1},{-1,-1,-1,-1,-1,0,-1,-1,-1,-1,0,0,-1,-1,-1,0,-1,-1,-1,-2,-1,-1,-1,-2,-1},{0,1,1,1,1,1,1,1,1,1,0,1,0,0,0,1,1,1,1,0,0,1,1,0,1},{1,0,0,0,-1,0,0,1,0,1,0,0,0,0,1,0,1,0,0,0,0,0,0,1,0},{-1,-1,0,0,0,1,0,0,0,-1,0,0,-1,0,-1,0,0,0,0,1,0,0,1,1,1},{-1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,1,1,1,1,0,0,0,0,-1},{1,0,0,0,0,0,-1,0,0,0,1,0,1,0,0,1,0,1,1,1,1,-1,0,0,-1},{1,0,0,0,0,1,1,0,0,0,0,0,-1,0,0,1,1,0,1,1,1,0,-1,0,-1},{1,0,0,0,-1,0,0,1,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,1,1},{-1,-1,0,0,0,1,0,0,0,-1,0,1,-1,0,0,0,0,0,0,1,0,0,1,1,1},{1,0,0,0,0,-1,-1,0,-1,-1,0,1,0,0,0,0,0,1,1,1,1,0,-1,0,-1},{-1,0,0,0,0,1,1,1,1,1,0,-1,0,0,0,0,0,0,-1,-1,0,0,-1,0,-1},{-1,-1,-1,-1,-1,1,0,0,0,0,1,1,0,0,0,0,0,1,0,0,-1,-1,-1,0,-1},
{-1,0,0,0,0,1,1,1,1,1,0,-1,0,0,0,1,0,0,-1,-1,-1,0,-1,0,-1},{1,0,0,0,0,0,0,0,-1,-1,0,1,0,0,0,0,0,1,1,1,0,-1,-1,0,-1},{1,0,0,0,0,0,1,1,1,1,-1,-1,0,0,0,0,0,0,-1,-1,1,0,-1,0,-1},{0,1,1,1,1,1,0,0,0,0,0,0,-1,-1,-1,0,-1,0,-1,-1,0,0,0,1,0},{-1,0,0,0,0,1,0,0,0,-1,0,-1,-1,-1,-1,0,1,0,0,1,-1,0,1,0,1},{-1,-1,0,0,0,1,0,0,0,-1,0,0,-1,-1,-1,0,0,0,0,1,-1,0,1,0,1},{1,0,0,0,0,0,1,1,0,1,-1,0,0,0,1,0,0,-1,0,-1,1,0,0,1,0},{1,0,0,0,0,0,0,0,0,-1,-1,-1,-1,-1,-1,0,1,0,0,1,0,0,1,0,1},{-1,-1,-1,-1,-1,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,-1,-1,0,-1},{1,0,0,0,0,0,0,0,0,-1,-1,-1,-1,-1,-1,-1,1,0,0,1,1,0,1,0,1},{-1,0,0,0,0,1,0,0,0,-1,0,-1,-1,0,-1,0,1,0,0,1,0,0,1,1,1},
{0,-1,0,0,-1,1,0,0,0,-1,-1,0,-1,-1,0,0,0,0,0,1,0,0,1,0,0},{0,0,0,0,-1,1,0,0,0,-1,0,1,0,0,1,0,0,1,0,1,0,0,0,1,0},{-1,-1,-1,0,-1,1,0,0,0,-1,0,0,1,-1,0,0,0,0,0,1,-1,0,-1,0,0},{1,0,0,0,-1,0,0,1,0,0,0,0,0,0,1,0,1,0,0,1,0,0,0,1,0},{1,0,0,0,0,0,0,0,0,-1,-1,-1,-1,-1,-1,-1,1,0,0,1,1,0,1,0,0},{-1,0,0,0,0,1,0,0,0,-1,0,0,-1,0,0,0,1,0,0,1,0,0,1,1,1},{-1,0,0,0,0,1,0,0,0,-1,0,-1,-1,-1,-1,0,1,0,0,1,0,0,1,0,0},{-1,-1,0,0,0,1,0,0,0,-1,0,0,-1,-1,-1,0,0,0,0,1,0,0,1,0,0},{1,0,0,0,0,0,1,0,1,1,-1,0,0,0,1,0,0,0,-1,-1,1,0,1,0,0},{1,0,0,0,0,0,0,0,0,-1,-1,-1,-1,-1,-1,0,1,0,0,1,1,0,1,0,0},{-1,-1,-1,-1,-1,1,0,0,0,0,0,1,0,0,0,1,0,1,0,0,-1,-1,-1,0,-1},{1,0,1,1,1,-1,0,0,0,0,-1,-1,-1,-1,-1,0,0,0,-1,-1,1,0,0,1,0},
{-1,0,-1,0,0,0,0,-1,0,0,0,1,0,0,0,0,1,0,1,1,0,0,-1,0,-1},{0,0,1,0,0,1,0,1,0,0,1,1,1,0,0,1,1,2,1,1,1,0,1,0,-1},{-1,-1,-1,-1,-1,0,0,-1,0,0,0,1,1,1,2,1,0,1,0,0,0,0,0,-1,-1},{1,0,0,0,0,0,0,-1,0,-1,-1,-1,-1,-1,-1,0,1,1,0,1,1,0,1,0,0},{1,0,0,0,0,0,1,1,1,1,-1,0,0,0,1,0,0,-1,-1,-1,1,0,1,0,0},{-1,0,0,0,0,1,1,1,1,1,0,-1,-1,0,0,0,0,-1,-1,-1,0,0,0,0,-1},{1,1,1,1,1,-1,0,0,0,1,0,0,-1,-1,-1,0,0,-1,0,-1,0,-1,0,0,0},{-1,0,0,0,0,1,1,1,1,1,0,0,-1,0,0,0,0,-1,-1,-1,0,-1,0,0,-1},{1,0,0,0,0,0,1,1,1,1,-1,0,0,0,1,-1,0,-1,-1,-1,1,0,1,0,0},{1,0,0,0,0,0,1,1,0,1,-1,0,0,0,1,0,0,-1,0,-1,1,0,1,1,0},{1,1,1,1,1,-1,0,0,0,1,0,0,0,-1,0,0,0,1,0,0,0,-1,-1,0,-1},{1,0,0,0,-1,-1,0,-1,0,1,-1,-1,-1,-1,-1,0,0,1,0,1,1,1,1,0,0},{-1,-1,-1,0,-1,1,0,0,0,-1,0,0,0,-1,0,0,0,0,0,1,-1,0,-1,0,0},{-1,-1,-1,-1,-1,1,0,1,0,0,0,1,1,1,2,0,0,-1,0,0,-1,0,-1,-1,-1},
{1,0,1,0,0,0,0,-1,0,-1,-1,-1,-1,-1,-1,-1,0,-1,0,1,1,1,1,0,0},{-1,-1,-1,0,0,1,0,0,0,-1,0,0,0,-1,-1,0,0,0,0,1,-1,0,-1,0,0},{-1,0,0,0,0,1,1,1,1,1,0,0,0,0,1,0,0,-1,-1,-1,0,0,1,0,0},{-1,0,-1,0,0,1,1,0,0,0,0,0,0,-1,0,0,-1,0,0,0,0,1,1,1,1},{1,0,0,0,0,0,1,0,0,0,-1,-1,-1,0,0,0,0,1,1,0,1,1,1,0,1},{-1,0,0,0,0,0,-1,0,0,0,0,0,-1,0,0,1,1,1,1,0,0,1,1,0,1},{-1,0,0,0,0,1,1,1,0,0,0,-1,0,-1,0,0,0,-1,0,0,0,1,1,1,1},{1,1,1,0,0,-1,-1,-1,-1,-1,0,0,-1,0,0,0,1,1,0,1,0,-1,0,0,0},{1,1,0,0,0,0,-1,1,0,0,-1,-1,-1,-1,-1,-1,-1,-1,0,0,1,1,0,1,0},{-1,-1,0,0,0,1,0,1,0,0,0,0,0,-1,0,0,0,-1,0,0,0,1,1,1,1},{-1,-1,0,0,0,1,0,0,0,0,1,1,1,0,0,1,1,0,1,0,-1,0,0,0,1},{1,1,0,0,0,-1,0,0,0,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1},{1,0,0,0,0,-1,-1,0,0,0,0,0,1,0,0,1,1,0,1,0,0,1,0,0,1},{-1,0,0,0,0,0,-1,0,0,0,0,0,-1,0,0,2,1,1,1,0,-1,1,0,0,1},{1,1,0,0,0,-1,0,0,0,0,1,0,1,0,0,0,0,0,1,0,0,1,0,0,1},{1,0,0,0,0,-1,-1,0,0,0,1,1,1,0,0,0,0,0,1,0,0,1,0,0,1},{1,1,0,0,0,0,0,0,1,0,0,-1,0,0,0,1,1,1,0,0,-1,0,0,0,1},{1,0,0,0,0,-1,-1,0,0,0,1,1,1,0,0,0,1,0,1,0,0,0,0,0,1},{1,0,0,0,0,0,1,0,0,0,-1,-1,-1,0,0,1,1,1,1,0,0,0,0,0,1},{-1,0,-1,0,0,1,1,0,0,0,-1,-1,0,-1,0,0,-1,0,0,0,0,1,0,1,1},
{1,1,0,0,0,1,1,0,1,0,0,-1,0,0,0,0,0,1,0,0,-1,0,0,0,1},{1,0,0,0,0,-1,-1,0,0,0,0,1,1,0,0,1,1,0,1,0,0,0,0,0,1},{1,0,0,0,0,-1,-1,0,-1,0,0,1,0,0,0,1,1,1,1,0,0,0,0,0,1},{0,1,0,-1,0,-1,-1,0,0,0,-1,-1,-1,0,0,0,-1,0,0,0,1,2,1,0,1},{-1,0,0,0,0,2,1,1,1,0,0,-1,0,0,0,0,0,0,-1,0,-1,1,0,0,1},{1,0,0,0,0,0,1,1,0,1,-2,-1,-1,-1,0,0,0,-1,0,-1,1,0,1,0,0},{1,0,0,0,0,1,1,1,0,0,-1,-1,-1,-1,-1,-1,0,-1,0,0,1,0,0,1,0},{2,1,1,0,0,-1,0,0,0,0,-1,-1,0,0,0,0,0,0,1,0,1,1,1,0,1},{-1,0,0,0,0,0,-1,0,0,0,0,0,-1,0,0,2,1,1,1,0,-1,0,1,0,1},{-1,-1,0,0,0,1,0,1,0,0,-1,0,-1,-1,0,0,0,-1,0,0,0,0,1,1,1},{-1,0,0,0,0,1,1,1,0,0,-1,-1,-1,-1,0,0,0,-1,0,0,0,0,1,1,1},
{1,0,0,0,0,1,1,1,0,0,-1,-1,-1,-1,-1,-1,0,-1,0,0,1,0,1,1,0},{0,0,-1,0,0,0,0,0,1,0,1,0,1,0,0,1,1,1,0,0,-1,0,0,0,1},{-2,-1,-1,-1,0,0,0,-1,0,0,1,0,0,1,-1,1,0,1,0,0,-1,0,0,-1,0},{1,0,0,0,0,1,1,1,1,0,-1,-1,-1,0,-1,-1,0,-1,-1,0,1,0,1,0,0},{1,0,0,0,0,0,1,1,0,0,-1,-1,-1,-1,-1,-1,0,-1,0,0,2,0,1,1,0},{1,0,1,0,0,1,0,1,1,0,0,0,-1,0,0,0,1,0,0,0,-1,0,0,0,1},{1,0,0,0,0,0,1,0,0,0,-1,0,-1,0,0,1,0,1,1,0,0,0,1,0,1},{1,1,1,0,0,-1,0,0,0,0,0,-1,0,0,0,1,0,0,1,0,0,1,1,0,1},{1,1,0,0,0,-1,0,0,0,0,-1,-1,-1,0,0,1,0,1,1,0,1,1,1,0,1},{-1,-1,-1,0,0,1,0,0,1,0,0,0,0,-1,-1,0,0,0,-1,0,-1,0,-1,0,0},{1,0,1,0,0,0,0,-1,1,0,-1,-1,-1,-1,-1,-1,0,-1,-1,0,1,1,1,0,0},{-1,-1,0,-1,0,1,0,1,0,0,0,0,-1,0,-1,0,0,-1,0,0,-1,0,0,-1,0},{-1,0,0,0,0,1,1,1,1,1,0,0,-1,0,0,0,0,-1,-1,-1,0,0,1,1,0},{1,1,1,1,1,-1,0,-1,-1,0,0,0,-1,-1,-1,0,0,0,1,0,0,-1,0,0,0},
{-1,0,0,0,0,1,1,1,1,1,0,-1,-1,0,0,0,0,-1,-1,-1,0,0,1,1,0},{1,0,0,0,0,0,1,1,1,1,-1,-1,-1,-1,0,-1,0,-1,-1,-1,1,0,1,0,0},{1,1,1,1,1,0,-1,-1,-1,-2,0,0,0,1,0,-1,-1,-1,-1,0,0,1,0,0,1},{-1,0,0,0,1,1,1,1,1,1,1,0,0,1,-1,0,-1,-1,-1,-1,-1,0,-1,-1,0},{1,1,1,1,1,-1,-1,-1,-2,-1,-1,0,0,0,1,0,-1,-1,0,-1,1,1,0,1,0},{-1,0,0,1,1,1,1,1,1,1,0,0,1,-1,0,0,-1,-1,-1,-1,-1,0,-1,0,0},{1,1,1,1,1,0,0,1,0,0,0,-1,-1,-1,-1,0,0,-1,-1,-1,0,0,0,1,0},{0,0,1,1,1,1,1,1,1,1,-1,0,-1,-1,0,0,-1,-1,-1,-1,0,0,1,0,0},
{-1,0,0,1,1,1,1,1,1,1,0,0,0,-1,0,0,-1,-1,-1,-1,-1,0,-1,0,0},{1,1,1,1,1,-1,-1,-2,-1,-1,-1,0,0,0,1,0,-1,0,-1,-1,1,1,1,0,0},{1,1,0,0,0,0,0,1,1,1,-1,0,0,0,1,-1,-2,-1,-1,-1,1,1,0,-1,-1},{-1,-1,0,0,0,1,1,1,1,1,0,1,0,1,1,0,-1,-1,-1,-1,0,0,0,0,-1},{1,1,1,1,1,0,-1,-1,-1,-2,0,0,0,1,0,-1,-1,-1,-1,0,1,2,1,1,1},{-1,0,0,0,1,1,1,1,1,1,1,0,0,1,-1,0,-1,-1,-1,-1,-1,1,0,0,1},{1,1,1,1,1,-1,-1,-1,-2,-1,-1,0,0,0,1,0,-1,-1,0,-1,1,2,1,1,1},{-1,-1,0,0,0,1,1,1,1,1,0,1,0,1,1,0,-1,-1,-1,-1,0,-1,0,0,-1},{1,1,1,1,1,0,-1,0,-1,-1,0,-1,-1,-1,-1,0,1,0,0,0,0,0,0,1,0},{-1,-1,0,0,0,1,1,1,1,1,0,1,0,0,1,0,-1,-1,-1,-1,-1,-1,0,-1,-1},
{0,1,1,1,1,1,1,1,1,1,0,0,-1,-1,-1,0,-1,0,-1,-1,0,0,0,1,0},{-1,-1,0,0,0,1,1,1,1,1,-1,0,-1,-1,0,0,-1,-1,-1,-1,0,0,1,0,0},{1,0,0,0,0,-1,-1,0,0,0,-1,0,-1,0,0,1,1,1,1,0,1,1,1,0,1},{1,1,1,0,0,-1,-1,-1,-1,-1,0,0,-1,0,0,-1,0,0,0,1,0,-1,0,0,0},{1,1,0,0,0,0,-1,1,0,0,-1,-1,-1,-1,-1,-1,-1,-1,0,0,2,2,1,1,0},{-1,-1,0,0,0,1,0,1,0,0,-1,0,-1,-1,0,0,0,-1,0,0,0,1,1,1,1},{-1,0,0,0,0,1,1,1,0,0,-1,-1,-1,-1,0,0,0,-1,0,0,0,1,1,1,1},{-1,0,0,0,0,0,-1,0,0,0,0,0,-1,0,0,2,1,1,1,0,-1,1,1,0,1},{1,0,0,0,0,0,1,0,0,0,-1,-1,-1,0,0,1,1,1,1,0,0,0,1,0,1},{-1,0,-1,0,0,1,1,0,0,0,-1,-1,0,-1,0,0,-1,0,0,0,0,1,1,1,1},{-2,-1,-1,-1,0,0,0,0,-1,0,1,0,0,0,-1,1,0,0,1,0,-1,0,-1,0,0},
{1,0,0,0,0,1,1,1,1,0,0,0,0,1,0,-1,0,-1,-1,0,0,0,1,0,1},{1,1,1,1,1,0,0,0,1,0,1,0,0,0,-1,0,0,1,0,0,-1,-1,-1,-1,0},{0,0,0,-1,0,0,0,-1,1,0,-1,-1,-1,-1,-1,1,0,1,1,0,1,1,1,0,0},{-2,-1,-1,-1,0,0,0,-1,0,0,1,0,0,0,-1,1,0,1,0,0,-1,0,0,-1,0},{1,0,0,0,0,1,1,1,1,0,-1,-1,-1,-1,-1,-1,0,-1,-1,0,1,0,1,0,0},{-1,0,0,0,0,1,1,1,1,1,-1,-1,-1,-1,0,0,0,-1,-1,-1,0,0,1,0,0},{1,0,0,0,0,0,1,1,1,1,-2,-1,-1,-1,0,0,0,-1,-1,-1,1,0,1,0,0},{1,1,0,0,0,0,0,1,1,1,-1,0,-1,-1,0,-1,-2,-1,-1,-1,1,1,1,0,0},{-1,-1,0,0,0,1,1,1,1,1,0,1,-1,0,0,0,-1,-1,-1,-1,0,0,1,1,0},{1,0,1,0,0,0,1,0,1,1,-1,-1,0,-1,0,-1,-1,-2,-1,-1,1,1,1,0,0},{-1,-1,-1,0,0,1,1,1,1,1,0,0,1,-1,0,0,-1,-1,-1,-1,-1,0,-1,0,0},{1,1,1,1,1,0,0,1,0,0,0,-1,-1,-1,-1,0,1,0,0,0,0,0,0,1,0},
{-1,-1,0,0,0,1,1,1,1,1,0,0,-1,0,0,0,-1,-1,-1,-1,0,0,1,1,0},{1,0,0,1,0,0,1,1,0,1,-1,-1,-1,0,0,-1,-1,-1,-2,-1,1,1,0,1,0},{1,1,1,1,1,0,-1,-1,-1,-2,-1,-1,-1,0,0,-1,-1,-1,-1,0,1,2,1,1,1},{-1,-1,0,0,0,1,1,1,1,1,0,1,0,0,1,0,-1,-1,-1,-1,0,0,1,0,0},{-1,-1,0,0,0,1,1,1,1,1,0,0,-1,0,0,0,-1,-1,-1,-1,0,0,0,0,-1},{1,1,0,0,0,0,0,1,1,1,-1,0,0,0,1,-1,-2,-1,-1,-1,1,1,1,0,0},{-1,-1,0,0,0,1,1,1,1,1,0,1,-1,0,0,0,-1,-1,-1,-1,0,-1,0,0,-1},{1,1,1,1,1,0,0,1,0,0,0,-1,-1,-1,-1,0,1,0,0,0,0,-1,-1,0,-1},{-1,-1,-1,0,0,1,1,1,1,1,0,1,1,0,1,0,-1,-1,-1,-1,-1,0,-1,0,0},{1,0,1,0,0,0,1,0,1,1,-1,0,0,0,1,-1,-1,-2,-1,-1,1,1,1,0,0},{-1,0,0,0,0,0,-1,0,-1,-1,1,1,0,0,0,1,1,1,1,1,-1,-1,-1,0,-1},{-1,-1,0,0,0,1,0,0,0,-1,0,0,-1,0,-1,0,0,0,0,1,0,1,1,1,1},{1,1,0,0,0,0,-1,0,0,-1,-1,-1,-1,-1,-1,-1,-1,0,0,1,1,2,1,0,1},
{1,1,0,-1,-1,-1,-1,0,0,0,-1,-1,-1,0,0,0,-1,0,0,0,1,1,0,0,-1},{-1,-1,0,0,0,1,0,0,0,-1,0,0,-1,0,0,0,0,0,0,1,0,1,1,1,1},{1,1,0,0,0,0,-1,0,0,-1,-1,-1,-1,-1,-1,-1,-1,0,0,1,1,1,1,0,0},{0,0,0,-1,-1,-1,-1,0,0,0,0,0,-1,0,0,0,-1,0,0,0,1,1,0,0,-1},{-1,0,0,0,0,1,1,1,1,1,0,-1,0,0,0,0,-1,0,-1,-1,0,0,-1,0,-1},{1,0,0,0,0,-1,-1,0,-1,-1,0,1,0,0,0,0,1,1,1,1,1,-1,-1,0,-1},{-1,0,0,0,0,1,0,0,0,-1,0,-1,-1,0,-1,0,1,0,0,1,0,1,1,1,1},{1,0,0,0,-1,-1,-1,-1,-1,-1,0,1,0,0,1,0,0,0,1,0,0,-1,0,0,0},
{-1,0,0,0,0,1,1,1,1,1,0,-1,0,0,0,1,0,0,-1,-1,-1,-1,-1,0,-1},{1,0,0,0,0,0,-1,0,-1,-1,0,1,0,0,0,0,1,1,1,1,0,-1,-1,0,-1},{-1,0,0,0,0,1,0,0,0,-1,0,-1,-1,0,0,0,1,0,0,1,0,1,1,1,1},{1,0,0,0,-1,-1,-1,-1,-1,-1,0,1,0,0,1,0,1,0,1,1,0,-1,0,0,0},{1,0,0,0,-1,-1,-1,-1,-1,-1,0,0,0,-1,0,0,0,1,0,0,0,0,0,1,1},{1,0,0,0,0,0,0,0,-1,-1,-1,-1,-1,-1,-1,0,1,0,1,1,1,0,1,1,0},{1,0,0,0,0,0,1,1,1,1,-1,0,0,0,1,-1,0,-1,-1,-1,1,-1,0,-1,-1},{-1,0,0,0,0,1,1,1,1,1,0,0,0,1,1,0,0,-1,-1,-1,0,-1,0,0,-1},{1,1,1,1,1,-1,0,0,0,1,0,0,-1,-1,-1,0,0,0,1,0,0,-1,0,0,0},
{-1,0,0,0,0,1,1,1,1,1,0,0,0,1,1,0,0,-1,-1,-1,0,0,0,0,-1},{1,0,0,0,0,0,1,1,1,1,-1,0,0,0,1,0,0,-1,-1,-1,0,-1,0,-1,-1},{1,0,0,0,0,0,0,0,-1,-1,-1,-1,-1,-1,-1,0,1,0,1,1,1,0,0,1,0},{-1,-1,-1,-1,-1,0,0,0,-1,0,0,1,1,1,2,1,0,0,1,0,0,0,-1,0,-1},{1,0,0,0,-1,-1,0,0,-1,1,-1,-1,-1,-1,-1,0,0,0,1,1,1,1,0,1,0},{-1,-1,-1,-1,-1,1,0,0,0,-1,1,1,1,2,1,0,0,0,0,1,-1,0,-1,-1,0},{-1,-1,-1,-1,-1,0,0,0,-1,0,0,1,1,1,2,1,0,0,1,0,-1,0,-1,-1,-1},{1,0,0,0,-1,-1,0,0,-1,1,-1,-1,-1,-1,-1,0,0,0,1,1,1,1,0,0,-1},{-1,-1,-1,-1,-1,1,0,0,0,-1,1,1,1,2,1,0,0,0,0,1,-1,0,-1,-1,-1},{-1,0,0,0,0,1,1,1,1,1,0,0,0,0,1,0,0,-1,-1,-1,-1,-1,0,-1,-1},{0,1,0,-1,0,-1,-1,0,0,0,0,0,-1,0,0,0,-1,0,0,0,1,2,1,1,1},
{1,0,0,0,0,-1,-1,0,-1,0,0,1,0,0,0,0,0,1,1,0,1,1,0,1,1},{1,1,0,1,0,-1,-1,-1,-1,-1,0,0,0,-1,0,0,1,0,1,1,0,-1,0,0,0},{1,1,0,0,0,0,-1,0,1,0,-1,-1,-1,-1,-1,-1,-1,0,-1,0,1,1,1,0,0},{-1,-1,0,0,0,1,0,0,1,0,0,0,-1,0,0,0,0,0,-1,0,0,1,1,1,1},{-1,0,0,0,0,1,1,0,1,0,0,-1,-1,0,0,0,0,0,-1,0,0,1,1,1,1},{-1,0,0,0,0,1,1,1,1,0,0,-1,0,0,0,0,0,0,-1,0,0,1,0,1,1},{-1,0,0,0,0,2,1,1,1,0,0,-1,0,0,0,0,0,0,-1,0,-1,1,0,1,1},{1,0,0,0,0,1,1,1,1,0,-1,-1,0,0,0,-1,0,0,-1,0,1,1,0,1,1},{1,0,0,0,0,-1,-1,0,-1,0,0,1,0,0,0,1,1,1,1,0,0,0,0,1,1},{0,1,0,-1,0,-1,-1,0,0,0,-1,-1,-1,0,0,0,-1,0,0,0,1,2,1,1,1},{1,1,0,0,0,-1,-1,0,-1,0,-1,-1,-1,-1,-1,0,-1,0,1,0,2,2,1,1,0},{0,0,0,-1,0,-1,-1,-1,-1,-1,1,1,0,1,0,-1,0,0,0,1,0,-1,0,0,0},{-1,0,0,0,0,0,0,0,-1,0,-1,-1,-1,-1,0,1,1,0,1,0,0,1,1,1,1},{-1,-1,0,0,0,0,0,0,-1,0,-1,0,-1,-1,0,1,0,0,1,0,0,1,1,1,1},{1,1,1,1,0,1,0,0,0,0,-1,0,-1,-1,0,-1,-1,0,-1,0,1,1,1,2,1},
{-2,-1,-1,-1,0,1,0,0,0,0,1,1,0,0,0,0,0,1,0,0,-1,0,0,1,1},{1,0,0,0,0,1,1,0,1,0,-1,-1,-1,-1,-1,-1,0,0,-1,0,1,0,1,0,0},{0,0,0,-1,0,0,0,1,0,0,1,0,0,1,0,1,1,0,1,0,-1,0,0,0,1},{1,0,0,0,0,-1,0,0,-1,0,-1,-1,-1,-1,-1,1,1,0,1,0,1,0,1,1,0},{-1,0,0,0,0,0,0,0,-1,0,-1,-1,-1,-1,0,1,1,0,1,0,0,0,1,1,1},{-1,-1,0,0,0,0,0,0,-1,0,-1,0,-1,-1,0,1,0,0,1,0,0,0,1,1,1},{0,0,0,-1,0,1,0,1,1,0,1,0,0,1,0,0,1,0,0,0,-1,0,0,0,1},{1,0,0,0,0,-1,0,0,-1,0,-1,-1,-1,-1,-1,0,1,0,1,0,2,0,1,1,0},{1,0,0,0,0,1,1,1,1,0,0,0,0,1,0,-1,0,-1,-1,0,0,0,0,0,1},{-2,-1,-1,-1,0,0,0,0,-1,0,1,0,1,0,-1,1,0,0,1,0,-1,0,-1,0,0},{1,0,0,0,0,0,1,0,1,1,-2,-1,-1,-1,0,0,0,0,-1,-1,1,0,1,0,0},{-2,-1,-1,-1,0,1,0,0,0,0,0,1,0,0,0,1,0,1,0,0,-1,0,0,1,1},
{1,0,0,0,0,-1,0,0,-1,0,0,1,0,0,0,1,0,1,1,0,0,0,0,1,1},{-1,0,0,0,0,2,1,1,1,0,0,-1,0,0,0,0,0,0,-1,0,-1,0,0,1,1},{0,0,1,0,0,1,0,1,0,0,1,1,1,0,0,0,0,1,-1,0,1,1,2,1,1},{1,1,1,1,0,1,1,1,1,1,1,0,0,0,-1,1,1,1,0,0,1,1,0,1,0},{0,0,1,1,1,1,1,1,1,1,0,-1,0,0,0,1,0,1,1,0,0,0,1,0,1},{-1,-1,-1,0,0,0,0,-1,0,0,0,-1,0,0,0,0,0,0,1,1,0,-1,-1,0,-1},{0,-1,0,0,0,0,0,-1,0,0,-1,0,0,0,1,-1,-1,-1,0,0,-1,-1,-1,-1,0},{1,1,0,0,0,0,1,0,0,0,1,1,1,0,0,0,1,0,-1,0,1,2,1,1,1},{-1,-1,-1,0,0,0,0,-1,0,0,0,-1,0,0,0,-1,-1,-1,-1,0,0,0,0,1,1},{-1,0,-1,0,0,0,0,-1,0,0,0,1,0,0,0,-1,0,-1,-1,0,0,1,0,1,1},{-1,-1,0,0,0,0,-1,0,0,0,0,0,1,0,0,-1,-1,0,-1,0,0,0,1,1,1},{0,-1,0,0,0,0,0,-1,0,0,-1,-1,-1,-1,0,-1,-1,-1,0,0,0,0,0,0,1},{-1,0,0,0,0,0,1,0,0,0,-1,0,-1,0,0,0,1,0,1,0,-1,1,0,0,1},{0,1,0,0,0,1,1,1,0,0,1,1,1,1,0,0,1,1,0,0,1,2,1,1,1},{1,0,0,0,0,1,1,0,0,0,0,0,-1,0,0,0,0,-1,-1,0,1,1,0,1,1},{1,0,0,0,0,0,-1,0,0,0,1,0,1,0,0,0,-1,0,-1,0,1,0,1,1,1},{-1,0,0,0,0,0,0,0,-1,0,1,1,0,0,0,1,0,1,1,0,-1,0,0,1,1},{-1,-1,0,0,0,1,0,0,1,0,0,0,-1,-1,-1,0,0,0,-1,0,0,0,1,0,0},
{-1,0,0,0,0,1,1,0,1,0,0,-1,-1,-1,-1,0,0,0,-1,0,0,0,1,0,0},{1,0,1,1,0,-1,0,0,0,0,-1,-1,-1,-1,0,0,0,0,-1,0,1,1,1,2,1},{-1,-1,-1,-1,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,1},{1,0,0,0,0,0,1,0,1,0,-1,-1,-1,-1,-1,-1,0,0,-1,0,1,0,1,0,0},{-1,0,0,0,0,1,1,0,1,0,0,0,-1,0,0,0,0,0,-1,0,0,0,1,1,1},{-1,-1,0,0,0,1,0,0,1,0,0,1,-1,0,0,0,0,0,-1,0,0,0,1,1,1},{-1,0,0,0,0,1,0,1,1,0,0,-1,0,0,0,0,0,0,-1,0,0,1,0,1,1},{1,0,0,0,0,-1,0,0,-1,0,0,1,0,0,0,0,0,1,1,0,1,0,0,1,1},{1,0,0,1,0,0,0,1,0,0,0,0,0,-1,0,0,1,0,0,0,0,0,0,1,1},{-1,0,0,-1,0,0,0,0,-1,0,1,1,0,1,0,1,0,1,1,0,-1,0,0,0,1},{-1,-1,0,0,0,0,0,0,-1,0,0,0,-1,-1,-1,1,0,0,1,0,0,0,1,1,0},{-1,0,0,0,0,0,0,0,-1,0,0,-1,-1,-1,-1,1,1,0,1,0,0,0,1,1,0},{-1,-1,0,-1,0,0,0,0,-1,0,0,0,-1,0,-1,1,0,0,1,0,0,0,1,0,0},{-1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,-1,0,0,-1,0,0,1,1,1,1},{-1,0,0,0,0,0,1,0,0,0,0,0,0,1,0,-1,0,-1,0,0,0,1,1,1,1},{-1,0,0,0,0,1,1,0,0,0,0,0,-1,0,0,1,0,1,1,0,-1,0,1,0,1},{-1,-1,0,0,0,1,0,1,0,0,0,0,-1,-1,-1,0,0,-1,0,0,0,0,0,1,0},
{-1,0,0,0,0,1,1,1,0,0,0,-1,-1,-1,-1,0,0,-1,0,0,0,0,0,1,0},{-1,-1,0,0,0,1,0,0,0,0,0,0,-1,0,0,1,1,1,1,0,-1,0,1,0,1},{1,1,1,0,0,-1,0,0,0,0,0,-1,0,0,0,0,0,0,1,0,1,1,1,0,1},{1,0,0,0,0,0,1,0,0,0,-1,0,-1,0,0,0,0,1,1,0,1,0,1,0,1},{-1,0,0,0,0,0,-1,0,0,0,0,0,-1,0,0,1,0,1,1,0,0,1,1,0,1},{-1,-1,0,0,0,1,0,1,0,0,0,1,0,-1,0,0,0,-1,0,0,0,0,1,1,1},{-1,0,0,0,0,1,1,1,0,0,0,0,0,-1,0,0,0,-1,0,0,0,0,1,1,1},{1,0,0,0,0,0,1,1,0,0,-1,-1,-1,-1,-1,-1,0,-1,0,0,1,0,0,1,0},{1,0,1,0,0,0,0,0,1,0,0,0,-1,0,0,0,1,0,0,0,0,0,1,0,1},{-1,0,-1,0,0,0,0,-1,0,0,1,1,1,0,0,1,0,1,1,0,-1,0,0,0,1},{-1,-1,-1,0,0,0,0,-1,0,0,0,0,0,-1,-1,1,0,1,0,0,0,0,0,1,0},{-1,0,0,0,0,1,1,1,0,0,0,-1,-1,-1,-1,0,0,-1,0,0,0,0,1,1,0},{-1,-1,0,0,0,1,0,1,0,0,0,0,-1,-1,-1,0,0,-1,0,0,0,0,1,1,0},{-1,0,0,0,0,-1,-1,0,0,0,0,0,1,0,0,0,0,1,1,0,-1,0,1,0,1},{1,0,0,0,0,0,-1,0,0,0,1,0,0,1,0,0,-1,-1,0,0,1,0,1,1,1},{1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,1,0,0,1,0,-1,0,0,0,1},{1,1,0,0,0,-1,0,0,0,0,0,-1,1,0,0,1,0,0,1,0,0,1,0,0,1},{1,0,0,0,0,-1,-1,0,0,0,0,0,1,0,0,1,1,0,1,0,0,0,0,0,1},{1,1,0,0,0,-1,0,0,0,0,0,0,1,0,0,1,0,0,1,0,0,0,0,0,1},{-1,0,0,0,0,2,1,1,1,0,0,-1,0,0,0,0,0,0,-1,0,-1,0,0,0,1},{-2,-1,-1,-1,0,1,0,0,0,0,1,1,0,0,0,0,0,1,0,0,-1,0,0,0,1},{1,0,0,0,0,1,1,0,1,0,-1,-1,-1,0,-1,-1,0,0,-1,0,1,0,1,0,0},{1,1,1,1,0,1,0,0,0,0,-1,0,-1,-1,0,-1,-1,0,-1,0,0,1,1,1,1},
{1,0,0,0,0,1,1,1,1,0,-1,-1,0,0,0,-1,0,0,-1,0,0,0,0,0,1},{-1,-1,0,0,0,0,0,0,0,1,-1,0,-1,-1,0,1,0,0,0,-1,0,0,1,0,0},{-1,0,0,0,0,0,1,0,0,1,-1,-1,-1,-1,0,1,0,0,0,-1,0,0,1,0,0},{1,0,0,0,0,-1,0,0,-1,0,0,1,0,0,0,1,0,1,1,0,0,0,0,0,1},{-2,-1,-1,-1,0,1,0,0,0,0,0,1,0,0,0,1,0,1,0,0,-1,0,0,0,1},{1,0,0,0,0,0,1,0,0,1,-2,-1,-1,-1,0,0,0,0,0,-1,1,0,1,0,0},{1,1,1,0,0,-1,0,0,0,0,0,-1,0,0,0,1,0,0,1,0,0,1,0,0,1},{1,0,0,0,0,0,1,0,0,0,-1,0,-1,0,0,1,0,1,1,0,0,0,0,0,1},{1,1,0,0,0,-1,0,0,0,0,-1,-1,-1,0,0,1,0,1,1,0,0,1,0,0,1},{-1,0,0,0,0,1,1,0,0,0,1,0,1,0,0,1,0,0,1,0,-2,0,0,0,1},{-1,-1,0,0,0,1,0,0,0,0,1,1,1,0,0,1,1,0,1,0,-2,-1,0,0,1},{2,1,1,0,0,-1,0,0,0,0,-1,-1,0,0,0,0,0,-1,1,0,1,1,1,0,1},{1,0,0,0,0,1,1,0,0,0,0,0,1,0,0,0,0,0,1,0,-1,0,0,0,1},{-1,0,0,0,0,1,1,0,0,0,1,0,1,0,0,1,0,0,1,0,-1,0,0,0,1},{-1,0,0,0,0,0,-1,0,0,0,0,0,-1,0,0,2,1,1,1,0,-1,0,0,0,1},{1,1,0,0,0,-1,0,0,0,0,1,0,1,0,0,0,0,0,1,0,0,0,0,0,1},{1,0,0,0,0,-1,-1,0,0,0,1,1,1,0,0,0,0,0,1,0,0,0,0,0,1},{1,0,0,0,0,-1,-1,0,0,0,-1,0,-1,0,0,1,1,1,1,0,0,0,0,0,1},{1,0,0,0,0,1,1,1,0,0,-1,-1,0,-1,-1,-1,0,-1,0,0,1,0,0,1,0},
{2,1,1,0,0,-1,0,0,0,0,-1,-1,0,0,0,0,0,0,1,0,1,1,0,0,1},{1,0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,0,0,1,0,-1,0,0,0,1},{1,1,0,0,0,-1,0,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,1,0,0,1},{0,1,0,0,0,-1,0,-1,0,0,1,1,0,1,0,0,1,0,1,1,0,1,-1,0,0},{-1,-1,0,0,0,0,-1,0,0,0,-1,-1,-1,0,0,0,-1,0,1,0,-1,-1,0,0,1},{0,0,-1,0,0,-1,0,-1,0,0,-1,-1,-1,0,0,0,0,-1,1,0,-1,0,-1,0,1},{1,0,1,1,0,-1,0,0,0,0,-1,-1,-1,-1,0,0,0,0,-1,0,1,1,1,1,1},{-1,0,0,0,0,1,1,0,1,0,0,-1,-1,0,-1,0,0,0,-1,0,0,0,1,0,0},{-1,-1,0,0,0,1,0,0,1,0,0,0,-1,0,-1,0,0,0,-1,0,0,0,1,0,0},{-1,0,0,0,0,0,0,0,-1,0,1,1,0,0,0,1,0,1,1,0,-1,0,0,0,1},{1,1,0,0,0,0,1,0,0,0,0,0,-1,0,0,1,1,0,1,0,0,1,0,0,1},{-1,0,0,0,0,1,1,1,1,0,0,-1,0,0,0,0,0,0,-1,0,-1,0,0,0,1},{-1,0,0,0,0,1,1,0,1,0,0,-1,-1,0,0,0,0,0,-1,0,-1,0,1,0,1},{-1,-1,0,0,0,1,0,0,1,0,0,0,-1,0,0,0,0,0,-1,0,-1,0,1,0,1},{1,1,0,0,0,0,-1,0,1,0,0,0,-1,0,-1,-1,-1,0,-1,0,1,1,1,0,0},{1,1,0,1,0,0,0,-1,0,-1,0,0,0,-1,0,-1,0,0,0,1,0,-1,0,0,0},{1,0,0,0,0,-1,-1,0,-1,0,0,1,0,0,0,0,0,1,1,0,0,0,0,0,1},{0,1,0,-1,0,-1,-1,0,0,0,0,0,-1,0,0,0,-1,0,0,0,0,1,1,0,1},{1,1,0,0,0,-1,-1,0,0,1,-1,0,-1,-1,0,0,-1,0,0,-1,1,1,1,0,0},
{-1,-1,0,0,0,0,0,0,0,1,0,0,-1,0,0,1,0,0,0,-1,0,0,1,1,0},{0,0,0,0,1,0,0,1,0,0,1,0,0,0,-1,0,1,0,0,0,0,0,0,1,0},{-1,-1,0,0,0,0,0,0,0,1,0,1,-1,0,0,1,0,0,0,-1,0,0,1,1,0},{1,0,1,0,0,-1,0,-1,0,1,-1,-1,0,-1,0,0,0,-1,0,-1,1,1,1,0,0},{-1,-1,-1,0,0,0,0,0,0,1,0,0,1,-1,0,1,0,0,0,-1,-1,0,-1,0,0},{1,0,0,1,0,-1,0,0,-1,1,-1,-1,-1,0,0,0,0,0,-1,-1,1,1,0,1,0},{-1,-1,-1,0,0,1,0,0,1,0,1,0,1,0,-1,0,0,0,-1,0,-1,0,-1,0,0},{-1,0,0,0,0,0,1,0,0,1,0,-1,-1,0,0,1,0,0,0,-1,0,0,1,1,0},{0,1,0,0,1,-1,0,-1,-1,0,1,0,0,0,-1,0,0,0,1,0,0,-1,0,0,0},{1,0,1,0,0,0,0,-1,1,0,0,-1,0,0,-1,-1,0,-1,-1,0,1,1,1,0,0},
{-1,-1,0,-1,0,1,0,1,0,0,1,0,0,1,-1,0,0,-1,0,0,-1,0,0,-1,0},{-1,0,0,0,0,0,1,0,0,1,0,0,-1,0,0,1,0,0,0,-1,0,0,1,1,0},{1,0,0,0,0,-1,1,0,0,1,-1,-1,-1,-1,0,0,0,0,0,-1,1,0,1,0,0},{1,0,1,0,0,0,0,1,0,0,0,-1,0,0,0,1,0,1,1,0,0,0,1,0,1},{1,1,1,0,0,0,0,1,0,0,0,1,0,0,0,1,1,1,1,0,0,1,1,0,1},{0,1,0,0,0,0,0,1,0,0,1,1,1,1,0,1,1,1,0,0,0,1,1,1,1},{-1,0,0,0,0,0,-1,0,0,0,0,0,-1,0,0,1,1,1,1,0,-1,0,0,0,1},{-1,0,0,0,0,1,1,1,0,0,0,-1,0,-1,0,0,0,-1,0,0,-1,0,0,1,1},{-1,-1,0,0,0,1,0,1,0,0,0,0,0,-1,0,0,0,-1,0,0,-1,0,0,1,1},{1,1,0,0,0,0,-1,1,0,0,0,0,0,-1,-1,-1,-1,-1,0,0,1,1,0,1,0},{-1,0,-1,0,0,1,1,0,0,0,0,0,0,-1,0,0,-1,0,0,0,-1,0,0,1,1},{1,0,0,0,0,0,1,0,0,0,-1,-1,-1,0,0,0,0,1,1,0,0,0,0,0,1},{1,1,1,0,0,0,0,0,-1,-1,0,0,-1,0,0,-1,0,0,0,1,0,-1,0,0,0},{-1,0,0,0,0,1,1,1,0,0,0,0,0,-1,0,0,0,-1,0,0,-1,0,0,1,1},{-1,-1,0,0,0,1,0,1,0,0,0,1,0,-1,0,0,0,-1,0,0,-1,0,0,1,1},
{-1,0,0,0,0,0,-1,0,0,0,0,0,-1,0,0,1,0,1,1,0,-1,1,0,0,1},{1,0,0,0,0,0,1,0,0,0,-1,0,-1,0,0,0,0,1,1,0,0,0,0,0,1},{1,0,1,0,0,0,0,0,1,0,0,0,-1,0,0,0,1,0,0,0,-1,0,0,0,1},{1,0,0,0,0,0,1,1,0,0,0,-1,0,-1,-1,-1,0,-1,0,0,1,0,0,1,0},{1,1,1,0,0,-1,0,0,0,0,0,-1,0,0,0,0,0,0,1,0,0,1,0,0,1},{1,0,0,0,0,0,-1,0,0,0,0,0,0,-1,0,1,0,1,0,0,0,0,0,0,1},{0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,-1,0,0,0,0,0,1,1,1,1},{-1,0,0,0,0,0,0,1,0,0,-1,-1,0,-1,0,-1,-1,0,0,0,-1,0,1,0,1},{1,1,0,0,0,-1,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1},{1,0,0,0,0,-1,-1,0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,0,0,1},{-1,0,0,0,0,0,-1,0,0,0,0,0,-1,0,0,1,1,0,1,0,-1,0,1,0,1},{-1,0,-1,0,0,1,1,0,0,0,0,0,1,-1,0,0,-1,0,0,0,-1,0,0,1,1},{1,0,0,0,0,0,1,0,0,0,-1,-1,-1,0,0,0,0,0,1,0,0,0,1,0,1},{1,0,0,0,0,-1,-1,0,0,0,0,1,1,0,0,0,0,0,1,0,0,0,0,0,1},{1,1,0,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1,0,0,-1,0,0,0,1},{1,0,0,0,0,-1,-1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,1,0,0,1},{1,1,0,0,0,-1,0,0,0,0,0,0,1,0,0,0,-1,0,1,0,0,1,0,0,1},{-1,0,0,0,0,0,-1,0,0,0,0,0,-1,0,0,1,0,0,1,0,-1,1,1,0,1},{1,1,1,0,0,-1,0,0,0,0,0,-1,0,0,0,0,0,-1,1,0,0,1,1,0,1},{1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,-1,0,0,0,1},{1,1,0,0,0,-1,0,0,0,0,0,-1,1,0,0,0,0,0,1,0,0,1,0,0,1},{1,0,0,0,0,0,1,0,0,0,-1,0,-1,0,0,0,0,0,1,0,0,0,1,0,1},{-1,0,0,0,0,1,1,0,1,0,0,0,-1,0,0,0,0,0,-1,0,-1,0,1,0,1},
{1,0,0,0,0,0,1,0,1,0,0,-1,-1,0,-1,-1,0,0,-1,0,1,0,1,0,0},{1,0,0,1,0,0,0,1,0,0,0,0,0,-1,0,0,1,0,0,0,-1,0,0,0,1},{-1,-1,0,0,0,1,0,0,1,0,0,1,-1,0,0,0,0,0,-1,0,-1,0,1,0,1},{-1,0,0,0,0,1,0,1,1,0,0,-1,0,0,0,0,0,0,-1,0,-1,1,0,0,1},{1,0,0,0,0,-1,0,0,-1,0,0,1,0,0,0,0,0,1,1,0,0,0,0,0,1},{-1,-1,-1,-1,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,-1,0,0,0,1},{1,0,0,0,0,0,-1,0,0,0,0,0,-1,0,0,1,0,0,1,0,0,0,0,0,1},{-1,0,-1,0,0,1,0,0,0,0,0,1,0,0,0,1,0,1,1,0,-1,0,0,0,1},{-1,0,0,0,0,0,-1,0,0,0,1,0,1,0,0,1,0,0,1,0,-1,1,0,0,1},{-1,-1,-1,0,0,1,0,0,0,0,0,1,0,0,0,1,0,1,1,0,-1,0,0,0,1},{-1,0,0,0,0,0,1,0,0,0,1,0,1,0,0,1,0,0,1,0,-1,0,0,0,1},{-1,-1,0,0,0,1,0,0,0,0,0,0,-1,0,0,1,1,1,1,0,-1,0,0,0,1},{-1,0,0,0,0,1,1,0,0,0,0,0,-1,0,0,1,0,1,1,0,-1,0,0,0,1},{-1,-1,0,0,0,1,0,1,0,0,0,0,0,-1,-1,0,0,-1,0,0,0,0,0,1,0},
{-1,0,0,0,0,1,1,1,0,0,0,-1,0,-1,-1,0,0,-1,0,0,0,0,0,1,0},{1,1,0,0,0,-1,0,0,0,0,-1,-1,-1,0,0,0,0,0,1,0,1,1,1,0,1},{1,0,0,0,0,-1,-1,0,0,0,-1,0,-1,0,0,0,0,0,1,0,1,1,1,0,1},{-1,-1,0,0,0,1,0,0,0,0,1,1,1,0,0,0,0,0,1,0,-1,0,0,0,1},{-1,0,0,0,0,0,-1,0,0,0,1,1,1,0,0,1,0,0,1,0,-1,0,0,0,1},{1,1,0,1,0,-1,-1,0,0,0,-1,0,-1,-1,0,0,-1,0,0,0,1,1,1,1,1},{-1,0,0,0,0,0,-1,0,0,0,1,0,1,0,0,1,1,0,1,0,-1,0,0,0,1},{-1,-1,0,0,0,1,0,0,0,0,0,0,1,0,0,1,1,0,1,0,-1,0,0,0,1},{-1,0,0,0,0,1,1,0,0,0,0,0,-1,0,0,1,0,0,1,0,-1,0,1,0,1},{-1,-1,0,0,0,1,0,0,0,0,0,0,-1,0,0,1,1,0,1,0,-1,0,1,0,1},{-1,0,0,0,0,1,1,0,0,0,0,0,1,0,0,1,0,0,1,0,-1,0,0,0,1},{-1,-1,-1,0,0,1,0,0,0,0,0,1,0,0,0,1,1,1,1,0,-1,-1,0,0,1},{-1,0,0,0,0,1,1,0,0,0,1,0,1,0,0,0,0,0,1,0,-1,0,0,0,1}
};*/

const small neigh_chg0[400][ndim][ndim] = {{{1,1,0,0,0},{-1,0,0,0,0},{0,-1,1,0,0},{0,0,0,1,0},{1,1,0,0,1}},{{1,0,0,0,0},{0,1,0,0,0},{-1,0,-1,0,0},{0,0,0,1,0},{1,0,1,0,1}},{{0,-1,0,0,0},{1,0,1,0,0},{1,0,0,1,0},{1,0,0,0,0},{1,0,1,1,1}},{{1,0,0,0,0},{-1,-1,0,0,0},{0,0,1,0,0},{0,0,0,1,0},{1,1,0,0,1}},{{1,1,0,0,0},{-1,0,0,0,0},{0,0,1,0,0},{0,-1,0,1,0},{1,1,0,0,1}},{{-1,0,0,0,0},{0,-1,0,0,0},{0,0,-1,0,0},{1,0,0,1,0},{0,1,1,0,1}},{{1,1,1,0,0},{-1,0,0,0,0},{0,-1,0,0,0},{0,0,-1,1,0},{1,1,1,0,1}},{{1,0,0,0,0},{0,1,0,0,0},{0,0,1,0,0},{0,0,0,1,0},{0,0,0,0,1}},{{-1,0,0,0,0},{0,0,1,0,0},{0,0,0,1,0},{-1,-1,0,0,0},{0,1,1,1,1}},{{1,2,0,1,0},{-1,-1,0,0,0},{-1,-1,-1,-1,0},{0,-1,0,0,0},{1,2,1,1,1}},{{-1,0,0,0,0},{0,-1,0,0,0},{1,1,1,0,0},{1,1,0,1,0},{-1,0,0,0,1}},{{1,1,0,1,0},{-1,-1,0,0,0},{-1,-1,-1,-1,0},{0,-1,0,0,0},{1,2,1,1,1}},{{-1,-1,0,0,0},{0,-1,0,0,0},{1,1,1,0,0},{1,1,0,1,0},{-1,0,0,0,1}},{{1,1,0,0,0},{0,0,0,1,0},{0,-1,0,0,0},{0,0,1,0,0},{0,1,0,0,1}},{{1,0,0,0,0},{-1,-1,0,0,0},{0,0,1,0,0},{0,1,0,1,0},{1,1,0,0,1}},{{-1,0,0,0,0},{0,-1,0,0,0},{0,0,-1,0,0},{1,1,0,1,0},{0,1,1,0,1}},{{-1,0,-1,0,0},{1,1,0,0,0},{0,0,1,-1,0},{0,-1,0,0,0},{0,1,0,1,1}},{{1,0,0,0,0},{0,1,0,0,0},{-1,-1,-1,0,0},{0,0,0,1,0},{1,1,1,0,1}},{{1,0,0,0,0},{-1,-1,0,0,0},{0,1,1,0,0},{0,0,0,1,0},{1,1,0,0,1}},{{1,1,0,0,0},{-1,0,0,0,0},{0,0,1,0,0},{0,0,0,1,0},{1,1,0,0,1}},{{-1,-1,-1,0,0},{1,0,0,0,0},{0,1,0,0,0},{1,1,1,1,0},{-1,0,0,0,1}},{{-1,0,0,0,0},{0,-1,0,0,0},{1,1,1,0,0},{1,0,0,1,0},{-1,1,0,0,1}},{{1,1,0,1,0},{-1,-1,0,0,0},{-1,0,-1,-1,0},{0,-1,0,0,0},{1,2,1,1,1}},{{-1,0,0,0,0},{0,-1,0,0,0},{1,0,1,0,0},{1,1,0,1,0},{-1,1,0,0,1}},{{1,1,0,0,0},{0,1,0,0,0},{1,1,1,0,0},{1,2,1,1,1},{1,1,0,0,-1}},{{-1,-1,0,0,0},{0,-1,0,0,0},{0,0,1,0,0},{0,0,1,1,1},{0,-1,0,0,-1}},{{-1,-1,-1,-1,-1},{0,-1,-1,-1,-1},{0,0,-1,-1,-1},{0,-1,-1,-1,-2},{-1,-1,-1,-2,-1}},{{0,1,1,1,1},{1,1,1,1,1},{0,1,0,0,0},{1,1,1,1,0},{0,1,1,0,1}},{{1,0,0,0,-1},{0,0,1,0,1},{0,0,0,0,1},{0,1,0,0,0},{0,0,0,1,0}},{{-1,-1,0,0,0},{1,0,0,0,-1},{0,0,-1,0,-1},{0,0,0,0,1},{0,0,1,1,1}},{{-1,0,0,0,0},{0,1,0,0,0},{0,0,1,0,0},{0,1,1,1,1},{0,0,0,0,-1}},{{1,0,0,0,0},{0,-1,0,0,0},{1,0,1,0,0},{1,0,1,1,1},{1,-1,0,0,-1}},{{1,0,0,0,0},{1,1,0,0,0},{0,0,-1,0,0},{1,1,0,1,1},{1,0,-1,0,-1}},{{1,0,0,0,-1},{0,0,1,0,0},{0,0,0,0,1},{0,1,0,0,0},{0,0,0,1,1}},{{-1,-1,0,0,0},{1,0,0,0,-1},{0,1,-1,0,0},{0,0,0,0,1},{0,0,1,1,1}},{{1,0,0,0,0},{-1,-1,0,-1,-1},{0,1,0,0,0},{0,0,1,1,1},{1,0,-1,0,-1}},{{-1,0,0,0,0},{1,1,1,1,1},{0,-1,0,0,0},{0,0,0,-1,-1},{0,0,-1,0,-1}},{{-1,-1,-1,-1,-1},{1,0,0,0,0},{1,1,0,0,0},{0,0,1,0,0},{-1,-1,-1,0,-1}},{{-1,0,0,0,0},{1,1,1,1,1},{0,-1,0,0,0},{1,0,0,-1,-1},{-1,0,-1,0,-1}},{{1,0,0,0,0},{0,0,0,-1,-1},{0,1,0,0,0},{0,0,1,1,1},{0,-1,-1,0,-1}},{{1,0,0,0,0},{0,1,1,1,1},{-1,-1,0,0,0},{0,0,0,-1,-1},{1,0,-1,0,-1}},{{0,1,1,1,1},{1,0,0,0,0},{0,0,-1,-1,-1},{0,-1,0,-1,-1},{0,0,0,1,0}},{{-1,0,0,0,0},{1,0,0,0,-1},{0,-1,-1,-1,-1},{0,1,0,0,1},{-1,0,1,0,1}},{{-1,-1,0,0,0},{1,0,0,0,-1},{0,0,-1,-1,-1},{0,0,0,0,1},{-1,0,1,0,1}},{{1,0,0,0,0},{0,1,1,0,1},{-1,0,0,0,1},{0,0,-1,0,-1},{1,0,0,1,0}},{{1,0,0,0,0},{0,0,0,0,-1},{-1,-1,-1,-1,-1},{0,1,0,0,1},{0,0,1,0,1}},{{-1,-1,-1,-1,-1},{1,0,0,0,0},{0,1,0,0,0},{0,0,1,0,0},{0,-1,-1,0,-1}},{{1,0,0,0,0},{0,0,0,0,-1},{-1,-1,-1,-1,-1},{-1,1,0,0,1},{1,0,1,0,1}},{{-1,0,0,0,0},{1,0,0,0,-1},{0,-1,-1,0,-1},{0,1,0,0,1},{0,0,1,1,1}},{{0,-1,0,0,-1},{1,0,0,0,-1},{-1,0,-1,-1,0},{0,0,0,0,1},{0,0,1,0,0}},{{0,0,0,0,-1},{1,0,0,0,-1},{0,1,0,0,1},{0,0,1,0,1},{0,0,0,1,0}},{{-1,-1,-1,0,-1},{1,0,0,0,-1},{0,0,1,-1,0},{0,0,0,0,1},{-1,0,-1,0,0}},{{1,0,0,0,-1},{0,0,1,0,0},{0,0,0,0,1},{0,1,0,0,1},{0,0,0,1,0}},{{1,0,0,0,0},{0,0,0,0,-1},{-1,-1,-1,-1,-1},{-1,1,0,0,1},{1,0,1,0,0}},{{-1,0,0,0,0},{1,0,0,0,-1},{0,0,-1,0,0},{0,1,0,0,1},{0,0,1,1,1}},{{-1,0,0,0,0},{1,0,0,0,-1},{0,-1,-1,-1,-1},{0,1,0,0,1},{0,0,1,0,0}},{{-1,-1,0,0,0},{1,0,0,0,-1},{0,0,-1,-1,-1},{0,0,0,0,1},{0,0,1,0,0}},{{1,0,0,0,0},{0,1,0,1,1},{-1,0,0,0,1},{0,0,0,-1,-1},{1,0,1,0,0}},{{1,0,0,0,0},{0,0,0,0,-1},{-1,-1,-1,-1,-1},{0,1,0,0,1},{1,0,1,0,0}},{{-1,-1,-1,-1,-1},{1,0,0,0,0},{0,1,0,0,0},{1,0,1,0,0},{-1,-1,-1,0,-1}},{{1,0,1,1,1},{-1,0,0,0,0},{-1,-1,-1,-1,-1},{0,0,0,-1,-1},{1,0,0,1,0}},{{-1,0,-1,0,0},{0,0,-1,0,0},{0,1,0,0,0},{0,1,0,1,1},{0,0,-1,0,-1}},{{0,0,1,0,0},{1,0,1,0,0},{1,1,1,0,0},{1,1,2,1,1},{1,0,1,0,-1}},{{-1,-1,-1,-1,-1},{0,0,-1,0,0},{0,1,1,1,2},{1,0,1,0,0},{0,0,0,-1,-1}},{{1,0,0,0,0},{0,0,-1,0,-1},{-1,-1,-1,-1,-1},{0,1,1,0,1},{1,0,1,0,0}},{{1,0,0,0,0},{0,1,1,1,1},{-1,0,0,0,1},{0,0,-1,-1,-1},{1,0,1,0,0}},{{-1,0,0,0,0},{1,1,1,1,1},{0,-1,-1,0,0},{0,0,-1,-1,-1},{0,0,0,0,-1}},{{1,1,1,1,1},{-1,0,0,0,1},{0,0,-1,-1,-1},{0,0,-1,0,-1},{0,-1,0,0,0}},{{-1,0,0,0,0},{1,1,1,1,1},{0,0,-1,0,0},{0,0,-1,-1,-1},{0,-1,0,0,-1}},{{1,0,0,0,0},{0,1,1,1,1},{-1,0,0,0,1},{-1,0,-1,-1,-1},{1,0,1,0,0}},{{1,0,0,0,0},{0,1,1,0,1},{-1,0,0,0,1},{0,0,-1,0,-1},{1,0,1,1,0}},{{1,1,1,1,1},{-1,0,0,0,1},{0,0,0,-1,0},{0,0,1,0,0},{0,-1,-1,0,-1}},{{1,0,0,0,-1},{-1,0,-1,0,1},{-1,-1,-1,-1,-1},{0,0,1,0,1},{1,1,1,0,0}},{{-1,-1,-1,0,-1},{1,0,0,0,-1},{0,0,0,-1,0},{0,0,0,0,1},{-1,0,-1,0,0}},{{-1,-1,-1,-1,-1},{1,0,1,0,0},{0,1,1,1,2},{0,0,-1,0,0},{-1,0,-1,-1,-1}},{{1,0,1,0,0},{0,0,-1,0,-1},{-1,-1,-1,-1,-1},{-1,0,-1,0,1},{1,1,1,0,0}},{{-1,-1,-1,0,0},{1,0,0,0,-1},{0,0,0,-1,-1},{0,0,0,0,1},{-1,0,-1,0,0}},{{-1,0,0,0,0},{1,1,1,1,1},{0,0,0,0,1},{0,0,-1,-1,-1},{0,0,1,0,0}},{{-1,0,-1,0,0},{1,1,0,0,0},{0,0,0,-1,0},{0,-1,0,0,0},{0,1,1,1,1}},{{1,0,0,0,0},{0,1,0,0,0},{-1,-1,-1,0,0},{0,0,1,1,0},{1,1,1,0,1}},{{-1,0,0,0,0},{0,-1,0,0,0},{0,0,-1,0,0},{1,1,1,1,0},{0,1,1,0,1}},{{-1,0,0,0,0},{1,1,1,0,0},{0,-1,0,-1,0},{0,0,-1,0,0},{0,1,1,1,1}},{{1,1,1,0,0},{-1,-1,-1,-1,-1},{0,0,-1,0,0},{0,1,1,0,1},{0,-1,0,0,0}},{{1,1,0,0,0},{0,-1,1,0,0},{-1,-1,-1,-1,-1},{-1,-1,-1,0,0},{1,1,0,1,0}},{{-1,-1,0,0,0},{1,0,1,0,0},{0,0,0,-1,0},{0,0,-1,0,0},{0,1,1,1,1}},{{-1,-1,0,0,0},{1,0,0,0,0},{1,1,1,0,0},{1,1,0,1,0},{-1,0,0,0,1}},{{1,1,0,0,0},{-1,0,0,0,0},{0,0,1,0,0},{1,0,0,1,0},{0,1,0,0,1}},{{1,0,0,0,0},{-1,-1,0,0,0},{0,0,1,0,0},{1,1,0,1,0},{0,1,0,0,1}},{{-1,0,0,0,0},{0,-1,0,0,0},{0,0,-1,0,0},{2,1,1,1,0},{-1,1,0,0,1}},{{1,1,0,0,0},{-1,0,0,0,0},{1,0,1,0,0},{0,0,0,1,0},{0,1,0,0,1}},{{1,0,0,0,0},{-1,-1,0,0,0},{1,1,1,0,0},{0,0,0,1,0},{0,1,0,0,1}},{{1,1,0,0,0},{0,0,0,1,0},{0,-1,0,0,0},{1,1,1,0,0},{-1,0,0,0,1}},{{1,0,0,0,0},{-1,-1,0,0,0},{1,1,1,0,0},{0,1,0,1,0},{0,0,0,0,1}},{{1,0,0,0,0},{0,1,0,0,0},{-1,-1,-1,0,0},{1,1,1,1,0},{0,0,0,0,1}},{{-1,0,-1,0,0},{1,1,0,0,0},{-1,-1,0,-1,0},{0,-1,0,0,0},{0,1,0,1,1}},{{1,1,0,0,0},{1,1,0,1,0},{0,-1,0,0,0},{0,0,1,0,0},{-1,0,0,0,1}},{{1,0,0,0,0},{-1,-1,0,0,0},{0,1,1,0,0},{1,1,0,1,0},{0,0,0,0,1}},{{1,0,0,0,0},{-1,-1,0,-1,0},{0,1,0,0,0},{1,1,1,1,0},{0,0,0,0,1}},{{0,1,0,-1,0},{-1,-1,0,0,0},{-1,-1,-1,0,0},{0,-1,0,0,0},{1,2,1,0,1}},{{-1,0,0,0,0},{2,1,1,1,0},{0,-1,0,0,0},{0,0,0,-1,0},{-1,1,0,0,1}},{{1,0,0,0,0},{0,1,1,0,1},{-2,-1,-1,-1,0},{0,0,-1,0,-1},{1,0,1,0,0}},{{1,0,0,0,0},{1,1,1,0,0},{-1,-1,-1,-1,-1},{-1,0,-1,0,0},{1,0,0,1,0}},{{2,1,1,0,0},{-1,0,0,0,0},{-1,-1,0,0,0},{0,0,0,1,0},{1,1,1,0,1}},{{-1,0,0,0,0},{0,-1,0,0,0},{0,0,-1,0,0},{2,1,1,1,0},{-1,0,1,0,1}},{{-1,-1,0,0,0},{1,0,1,0,0},{-1,0,-1,-1,0},{0,0,-1,0,0},{0,0,1,1,1}},{{-1,0,0,0,0},{1,1,1,0,0},{-1,-1,-1,-1,0},{0,0,-1,0,0},{0,0,1,1,1}},{{1,0,0,0,0},{1,1,1,0,0},{-1,-1,-1,-1,-1},{-1,0,-1,0,0},{1,0,1,1,0}},{{0,0,-1,0,0},{0,0,0,1,0},{1,0,1,0,0},{1,1,1,0,0},{-1,0,0,0,1}},{{-2,-1,-1,-1,0},{0,0,-1,0,0},{1,0,0,1,-1},{1,0,1,0,0},{-1,0,0,-1,0}},{{1,0,0,0,0},{1,1,1,1,0},{-1,-1,-1,0,-1},{-1,0,-1,-1,0},{1,0,1,0,0}},{{1,0,0,0,0},{0,1,1,0,0},{-1,-1,-1,-1,-1},{-1,0,-1,0,0},{2,0,1,1,0}},{{1,0,1,0,0},{1,0,1,1,0},{0,0,-1,0,0},{0,1,0,0,0},{-1,0,0,0,1}},{{1,0,0,0,0},{0,1,0,0,0},{-1,0,-1,0,0},{1,0,1,1,0},{0,0,1,0,1}},{{1,1,1,0,0},{-1,0,0,0,0},{0,-1,0,0,0},{1,0,0,1,0},{0,1,1,0,1}},{{1,1,0,0,0},{-1,0,0,0,0},{-1,-1,-1,0,0},{1,0,1,1,0},{1,1,1,0,1}},{{-1,-1,-1,0,0},{1,0,0,1,0},{0,0,0,-1,-1},{0,0,0,-1,0},{-1,0,-1,0,0}},{{1,0,1,0,0},{0,0,-1,1,0},{-1,-1,-1,-1,-1},{-1,0,-1,-1,0},{1,1,1,0,0}},{{-1,-1,0,-1,0},{1,0,1,0,0},{0,0,-1,0,-1},{0,0,-1,0,0},{-1,0,0,-1,0}},{{-1,0,0,0,0},{1,1,1,1,1},{0,0,-1,0,0},{0,0,-1,-1,-1},{0,0,1,1,0}},{{1,1,1,1,1},{-1,0,-1,-1,0},{0,0,-1,-1,-1},{0,0,0,1,0},{0,-1,0,0,0}},{{-1,0,0,0,0},{1,1,1,1,1},{0,-1,-1,0,0},{0,0,-1,-1,-1},{0,0,1,1,0}},{{1,0,0,0,0},{0,1,1,1,1},{-1,-1,-1,-1,0},{-1,0,-1,-1,-1},{1,0,1,0,0}},{{1,1,1,1,1},{0,-1,-1,-1,-2},{0,0,0,1,0},{-1,-1,-1,-1,0},{0,1,0,0,1}},{{-1,0,0,0,1},{1,1,1,1,1},{1,0,0,1,-1},{0,-1,-1,-1,-1},{-1,0,-1,-1,0}},{{1,1,1,1,1},{-1,-1,-1,-2,-1},{-1,0,0,0,1},{0,-1,-1,0,-1},{1,1,0,1,0}},{{-1,0,0,1,1},{1,1,1,1,1},{0,0,1,-1,0},{0,-1,-1,-1,-1},{-1,0,-1,0,0}},{{1,1,1,1,1},{0,0,1,0,0},{0,-1,-1,-1,-1},{0,0,-1,-1,-1},{0,0,0,1,0}},{{0,0,1,1,1},{1,1,1,1,1},{-1,0,-1,-1,0},{0,-1,-1,-1,-1},{0,0,1,0,0}},{{-1,0,0,1,1},{1,1,1,1,1},{0,0,0,-1,0},{0,-1,-1,-1,-1},{-1,0,-1,0,0}},{{1,1,1,1,1},{-1,-1,-2,-1,-1},{-1,0,0,0,1},{0,-1,0,-1,-1},{1,1,1,0,0}},{{1,1,0,0,0},{0,0,1,1,1},{-1,0,0,0,1},{-1,-2,-1,-1,-1},{1,1,0,-1,-1}},{{-1,-1,0,0,0},{1,1,1,1,1},{0,1,0,1,1},{0,-1,-1,-1,-1},{0,0,0,0,-1}},{{1,1,1,1,1},{0,-1,-1,-1,-2},{0,0,0,1,0},{-1,-1,-1,-1,0},{1,2,1,1,1}},{{-1,0,0,0,1},{1,1,1,1,1},{1,0,0,1,-1},{0,-1,-1,-1,-1},{-1,1,0,0,1}},{{1,1,1,1,1},{-1,-1,-1,-2,-1},{-1,0,0,0,1},{0,-1,-1,0,-1},{1,2,1,1,1}},{{-1,-1,0,0,0},{1,1,1,1,1},{0,1,0,1,1},{0,-1,-1,-1,-1},{0,-1,0,0,-1}},{{1,1,1,1,1},{0,-1,0,-1,-1},{0,-1,-1,-1,-1},{0,1,0,0,0},{0,0,0,1,0}},{{-1,-1,0,0,0},{1,1,1,1,1},{0,1,0,0,1},{0,-1,-1,-1,-1},{-1,-1,0,-1,-1}},{{0,1,1,1,1},{1,1,1,1,1},{0,0,-1,-1,-1},{0,-1,0,-1,-1},{0,0,0,1,0}},{{-1,-1,0,0,0},{1,1,1,1,1},{-1,0,-1,-1,0},{0,-1,-1,-1,-1},{0,0,1,0,0}},{{1,0,0,0,0},{-1,-1,0,0,0},{-1,0,-1,0,0},{1,1,1,1,0},{1,1,1,0,1}},{{1,1,1,0,0},{-1,-1,-1,-1,-1},{0,0,-1,0,0},{-1,0,0,0,1},{0,-1,0,0,0}},{{1,1,0,0,0},{0,-1,1,0,0},{-1,-1,-1,-1,-1},{-1,-1,-1,0,0},{2,2,1,1,0}},{{-1,-1,0,0,0},{1,0,1,0,0},{-1,0,-1,-1,0},{0,0,-1,0,0},{0,1,1,1,1}},{{-1,0,0,0,0},{1,1,1,0,0},{-1,-1,-1,-1,0},{0,0,-1,0,0},{0,1,1,1,1}},{{-1,0,0,0,0},{0,-1,0,0,0},{0,0,-1,0,0},{2,1,1,1,0},{-1,1,1,0,1}},{{1,0,0,0,0},{0,1,0,0,0},{-1,-1,-1,0,0},{1,1,1,1,0},{0,0,1,0,1}},{{-1,0,-1,0,0},{1,1,0,0,0},{-1,-1,0,-1,0},{0,-1,0,0,0},{0,1,1,1,1}},{{-2,-1,-1,-1,0},{0,0,0,-1,0},{1,0,0,0,-1},{1,0,0,1,0},{-1,0,-1,0,0}},{{1,0,0,0,0},{1,1,1,1,0},{0,0,0,1,0},{-1,0,-1,-1,0},{0,0,1,0,1}},{{1,1,1,1,1},{0,0,0,1,0},{1,0,0,0,-1},{0,0,1,0,0},{-1,-1,-1,-1,0}},{{0,0,0,-1,0},{0,0,-1,1,0},{-1,-1,-1,-1,-1},{1,0,1,1,0},{1,1,1,0,0}},{{-2,-1,-1,-1,0},{0,0,-1,0,0},{1,0,0,0,-1},{1,0,1,0,0},{-1,0,0,-1,0}},{{1,0,0,0,0},{1,1,1,1,0},{-1,-1,-1,-1,-1},{-1,0,-1,-1,0},{1,0,1,0,0}},{{-1,0,0,0,0},{1,1,1,1,1},{-1,-1,-1,-1,0},{0,0,-1,-1,-1},{0,0,1,0,0}},{{1,0,0,0,0},{0,1,1,1,1},{-2,-1,-1,-1,0},{0,0,-1,-1,-1},{1,0,1,0,0}},{{1,1,0,0,0},{0,0,1,1,1},{-1,0,-1,-1,0},{-1,-2,-1,-1,-1},{1,1,1,0,0}},{{-1,-1,0,0,0},{1,1,1,1,1},{0,1,-1,0,0},{0,-1,-1,-1,-1},{0,0,1,1,0}},{{1,0,1,0,0},{0,1,0,1,1},{-1,-1,0,-1,0},{-1,-1,-2,-1,-1},{1,1,1,0,0}},{{-1,-1,-1,0,0},{1,1,1,1,1},{0,0,1,-1,0},{0,-1,-1,-1,-1},{-1,0,-1,0,0}},{{1,1,1,1,1},{0,0,1,0,0},{0,-1,-1,-1,-1},{0,1,0,0,0},{0,0,0,1,0}},{{-1,-1,0,0,0},{1,1,1,1,1},{0,0,-1,0,0},{0,-1,-1,-1,-1},{0,0,1,1,0}},{{1,0,0,1,0},{0,1,1,0,1},{-1,-1,-1,0,0},{-1,-1,-1,-2,-1},{1,1,0,1,0}},{{1,1,1,1,1},{0,-1,-1,-1,-2},{-1,-1,-1,0,0},{-1,-1,-1,-1,0},{1,2,1,1,1}},{{-1,-1,0,0,0},{1,1,1,1,1},{0,1,0,0,1},{0,-1,-1,-1,-1},{0,0,1,0,0}},{{-1,-1,0,0,0},{1,1,1,1,1},{0,0,-1,0,0},{0,-1,-1,-1,-1},{0,0,0,0,-1}},{{1,1,0,0,0},{0,0,1,1,1},{-1,0,0,0,1},{-1,-2,-1,-1,-1},{1,1,1,0,0}},{{-1,-1,0,0,0},{1,1,1,1,1},{0,1,-1,0,0},{0,-1,-1,-1,-1},{0,-1,0,0,-1}},{{1,1,1,1,1},{0,0,1,0,0},{0,-1,-1,-1,-1},{0,1,0,0,0},{0,-1,-1,0,-1}},{{-1,-1,-1,0,0},{1,1,1,1,1},{0,1,1,0,1},{0,-1,-1,-1,-1},{-1,0,-1,0,0}},{{1,0,1,0,0},{0,1,0,1,1},{-1,0,0,0,1},{-1,-1,-2,-1,-1},{1,1,1,0,0}},{{-1,0,0,0,0},{0,-1,0,-1,-1},{1,1,0,0,0},{1,1,1,1,1},{-1,-1,-1,0,-1}},{{-1,-1,0,0,0},{1,0,0,0,-1},{0,0,-1,0,-1},{0,0,0,0,1},{0,1,1,1,1}},{{1,1,0,0,0},{0,-1,0,0,-1},{-1,-1,-1,-1,-1},{-1,-1,0,0,1},{1,2,1,0,1}},{{1,1,0,-1,-1},{-1,-1,0,0,0},{-1,-1,-1,0,0},{0,-1,0,0,0},{1,1,0,0,-1}},{{-1,-1,0,0,0},{1,0,0,0,-1},{0,0,-1,0,0},{0,0,0,0,1},{0,1,1,1,1}},{{1,1,0,0,0},{0,-1,0,0,-1},{-1,-1,-1,-1,-1},{-1,-1,0,0,1},{1,1,1,0,0}},{{0,0,0,-1,-1},{-1,-1,0,0,0},{0,0,-1,0,0},{0,-1,0,0,0},{1,1,0,0,-1}},{{-1,0,0,0,0},{1,1,1,1,1},{0,-1,0,0,0},{0,-1,0,-1,-1},{0,0,-1,0,-1}},{{1,0,0,0,0},{-1,-1,0,-1,-1},{0,1,0,0,0},{0,1,1,1,1},{1,-1,-1,0,-1}},{{-1,0,0,0,0},{1,0,0,0,-1},{0,-1,-1,0,-1},{0,1,0,0,1},{0,1,1,1,1}},{{1,0,0,0,-1},{-1,-1,-1,-1,-1},{0,1,0,0,1},{0,0,0,1,0},{0,-1,0,0,0}},{{-1,0,0,0,0},{1,1,1,1,1},{0,-1,0,0,0},{1,0,0,-1,-1},{-1,-1,-1,0,-1}},{{1,0,0,0,0},{0,-1,0,-1,-1},{0,1,0,0,0},{0,1,1,1,1},{0,-1,-1,0,-1}},{{-1,0,0,0,0},{1,0,0,0,-1},{0,-1,-1,0,0},{0,1,0,0,1},{0,1,1,1,1}},{{1,0,0,0,-1},{-1,-1,-1,-1,-1},{0,1,0,0,1},{0,1,0,1,1},{0,-1,0,0,0}},{{1,0,0,0,-1},{-1,-1,-1,-1,-1},{0,0,0,-1,0},{0,0,1,0,0},{0,0,0,1,1}},{{1,0,0,0,0},{0,0,0,-1,-1},{-1,-1,-1,-1,-1},{0,1,0,1,1},{1,0,1,1,0}},{{1,0,0,0,0},{0,1,1,1,1},{-1,0,0,0,1},{-1,0,-1,-1,-1},{1,-1,0,-1,-1}},{{-1,0,0,0,0},{1,1,1,1,1},{0,0,0,1,1},{0,0,-1,-1,-1},{0,-1,0,0,-1}},{{1,1,1,1,1},{-1,0,0,0,1},{0,0,-1,-1,-1},{0,0,0,1,0},{0,-1,0,0,0}},{{-1,0,0,0,0},{1,1,1,1,1},{0,0,0,1,1},{0,0,-1,-1,-1},{0,0,0,0,-1}},{{1,0,0,0,0},{0,1,1,1,1},{-1,0,0,0,1},{0,0,-1,-1,-1},{0,-1,0,-1,-1}},{{1,0,0,0,0},{0,0,0,-1,-1},{-1,-1,-1,-1,-1},{0,1,0,1,1},{1,0,0,1,0}},{{-1,-1,-1,-1,-1},{0,0,0,-1,0},{0,1,1,1,2},{1,0,0,1,0},{0,0,-1,0,-1}},{{1,0,0,0,-1},{-1,0,0,-1,1},{-1,-1,-1,-1,-1},{0,0,0,1,1},{1,1,0,1,0}},{{-1,-1,-1,-1,-1},{1,0,0,0,-1},{1,1,1,2,1},{0,0,0,0,1},{-1,0,-1,-1,0}},{{-1,-1,-1,-1,-1},{0,0,0,-1,0},{0,1,1,1,2},{1,0,0,1,0},{-1,0,-1,-1,-1}},{{1,0,0,0,-1},{-1,0,0,-1,1},{-1,-1,-1,-1,-1},{0,0,0,1,1},{1,1,0,0,-1}},{{-1,-1,-1,-1,-1},{1,0,0,0,-1},{1,1,1,2,1},{0,0,0,0,1},{-1,0,-1,-1,-1}},{{-1,0,0,0,0},{1,1,1,1,1},{0,0,0,0,1},{0,0,-1,-1,-1},{-1,-1,0,-1,-1}},{{0,1,0,-1,0},{-1,-1,0,0,0},{0,0,-1,0,0},{0,-1,0,0,0},{1,2,1,1,1}},{{1,0,0,0,0},{-1,-1,0,-1,0},{0,1,0,0,0},{0,0,1,1,0},{1,1,0,1,1}},{{1,1,0,1,0},{-1,-1,-1,-1,-1},{0,0,0,-1,0},{0,1,0,1,1},{0,-1,0,0,0}},{{1,1,0,0,0},{0,-1,0,1,0},{-1,-1,-1,-1,-1},{-1,-1,0,-1,0},{1,1,1,0,0}},{{-1,-1,0,0,0},{1,0,0,1,0},{0,0,-1,0,0},{0,0,0,-1,0},{0,1,1,1,1}},{{-1,0,0,0,0},{1,1,0,1,0},{0,-1,-1,0,0},{0,0,0,-1,0},{0,1,1,1,1}},{{-1,0,0,0,0},{1,1,1,1,0},{0,-1,0,0,0},{0,0,0,-1,0},{0,1,0,1,1}},{{-1,0,0,0,0},{2,1,1,1,0},{0,-1,0,0,0},{0,0,0,-1,0},{-1,1,0,1,1}},{{1,0,0,0,0},{1,1,1,1,0},{-1,-1,0,0,0},{-1,0,0,-1,0},{1,1,0,1,1}},{{1,0,0,0,0},{-1,-1,0,-1,0},{0,1,0,0,0},{1,1,1,1,0},{0,0,0,1,1}},{{0,1,0,-1,0},{-1,-1,0,0,0},{-1,-1,-1,0,0},{0,-1,0,0,0},{1,2,1,1,1}},{{1,1,0,0,0},{-1,-1,0,-1,0},{-1,-1,-1,-1,-1},{0,-1,0,1,0},{2,2,1,1,0}},{{0,0,0,-1,0},{-1,-1,-1,-1,-1},{1,1,0,1,0},{-1,0,0,0,1},{0,-1,0,0,0}},{{-1,0,0,0,0},{0,0,0,-1,0},{-1,-1,-1,-1,0},{1,1,0,1,0},{0,1,1,1,1}},{{-1,-1,0,0,0},{0,0,0,-1,0},{-1,0,-1,-1,0},{1,0,0,1,0},{0,1,1,1,1}},{{1,1,1,1,0},{1,0,0,0,0},{-1,0,-1,-1,0},{-1,-1,0,-1,0},{1,1,1,2,1}},{{-2,-1,-1,-1,0},{1,0,0,0,0},{1,1,0,0,0},{0,0,1,0,0},{-1,0,0,1,1}},{{1,0,0,0,0},{1,1,0,1,0},{-1,-1,-1,-1,-1},{-1,0,0,-1,0},{1,0,1,0,0}},{{0,0,0,-1,0},{0,0,1,0,0},{1,0,0,1,0},{1,1,0,1,0},{-1,0,0,0,1}},{{1,0,0,0,0},{-1,0,0,-1,0},{-1,-1,-1,-1,-1},{1,1,0,1,0},{1,0,1,1,0}},{{-1,0,0,0,0},{0,0,0,-1,0},{-1,-1,-1,-1,0},{1,1,0,1,0},{0,0,1,1,1}},{{-1,-1,0,0,0},{0,0,0,-1,0},{-1,0,-1,-1,0},{1,0,0,1,0},{0,0,1,1,1}},{{0,0,0,-1,0},{1,0,1,1,0},{1,0,0,1,0},{0,1,0,0,0},{-1,0,0,0,1}},{{1,0,0,0,0},{-1,0,0,-1,0},{-1,-1,-1,-1,-1},{0,1,0,1,0},{2,0,1,1,0}},{{1,0,0,0,0},{1,1,1,1,0},{0,0,0,1,0},{-1,0,-1,-1,0},{0,0,0,0,1}},{{-2,-1,-1,-1,0},{0,0,0,-1,0},{1,0,1,0,-1},{1,0,0,1,0},{-1,0,-1,0,0}},{{1,0,0,0,0},{0,1,0,1,1},{-2,-1,-1,-1,0},{0,0,0,-1,-1},{1,0,1,0,0}},{{-2,-1,-1,-1,0},{1,0,0,0,0},{0,1,0,0,0},{1,0,1,0,0},{-1,0,0,1,1}},{{1,0,0,0,0},{-1,0,0,-1,0},{0,1,0,0,0},{1,0,1,1,0},{0,0,0,1,1}},{{-1,0,0,0,0},{2,1,1,1,0},{0,-1,0,0,0},{0,0,0,-1,0},{-1,0,0,1,1}},{{0,0,1,0,0},{1,0,1,0,0},{1,1,1,0,0},{0,0,1,-1,0},{1,1,2,1,1}},{{1,1,1,1,0},{1,1,1,1,1},{1,0,0,0,-1},{1,1,1,0,0},{1,1,0,1,0}},{{0,0,1,1,1},{1,1,1,1,1},{0,-1,0,0,0},{1,0,1,1,0},{0,0,1,0,1}},{{-1,-1,-1,0,0},{0,0,-1,0,0},{0,-1,0,0,0},{0,0,0,1,1},{0,-1,-1,0,-1}},{{0,-1,0,0,0},{0,0,-1,0,0},{-1,0,0,0,1},{-1,-1,-1,0,0},{-1,-1,-1,-1,0}},{{1,1,0,0,0},{0,1,0,0,0},{1,1,1,0,0},{0,1,0,-1,0},{1,2,1,1,1}},{{-1,-1,-1,0,0},{0,0,-1,0,0},{0,-1,0,0,0},{-1,-1,-1,-1,0},{0,0,0,1,1}},{{-1,0,-1,0,0},{0,0,-1,0,0},{0,1,0,0,0},{-1,0,-1,-1,0},{0,1,0,1,1}},{{-1,-1,0,0,0},{0,-1,0,0,0},{0,0,1,0,0},{-1,-1,0,-1,0},{0,0,1,1,1}},{{0,-1,0,0,0},{0,0,-1,0,0},{-1,-1,-1,-1,0},{-1,-1,-1,0,0},{0,0,0,0,1}},{{-1,0,0,0,0},{0,1,0,0,0},{-1,0,-1,0,0},{0,1,0,1,0},{-1,1,0,0,1}},{{0,1,0,0,0},{1,1,1,0,0},{1,1,1,1,0},{0,1,1,0,0},{1,2,1,1,1}},{{1,0,0,0,0},{1,1,0,0,0},{0,0,-1,0,0},{0,0,-1,-1,0},{1,1,0,1,1}},{{1,0,0,0,0},{0,-1,0,0,0},{1,0,1,0,0},{0,-1,0,-1,0},{1,0,1,1,1}},{{-1,0,0,0,0},{0,0,0,-1,0},{1,1,0,0,0},{1,0,1,1,0},{-1,0,0,1,1}},{{-1,-1,0,0,0},{1,0,0,1,0},{0,0,-1,-1,-1},{0,0,0,-1,0},{0,0,1,0,0}},{{-1,0,0,0,0},{1,1,0,1,0},{0,-1,-1,-1,-1},{0,0,0,-1,0},{0,0,1,0,0}},{{1,0,1,1,0},{-1,0,0,0,0},{-1,-1,-1,-1,0},{0,0,0,-1,0},{1,1,1,2,1}},{{-1,-1,-1,-1,0},{1,0,0,0,0},{0,1,0,0,0},{0,0,1,0,0},{0,0,0,1,1}},{{1,0,0,0,0},{0,1,0,1,0},{-1,-1,-1,-1,-1},{-1,0,0,-1,0},{1,0,1,0,0}},{{-1,0,0,0,0},{1,1,0,1,0},{0,0,-1,0,0},{0,0,0,-1,0},{0,0,1,1,1}},{{-1,-1,0,0,0},{1,0,0,1,0},{0,1,-1,0,0},{0,0,0,-1,0},{0,0,1,1,1}},{{-1,0,0,0,0},{1,0,1,1,0},{0,-1,0,0,0},{0,0,0,-1,0},{0,1,0,1,1}},{{1,0,0,0,0},{-1,0,0,-1,0},{0,1,0,0,0},{0,0,1,1,0},{1,0,0,1,1}},{{1,0,0,1,0},{0,0,1,0,0},{0,0,0,-1,0},{0,1,0,0,0},{0,0,0,1,1}},{{-1,0,0,-1,0},{0,0,0,-1,0},{1,1,0,1,0},{1,0,1,1,0},{-1,0,0,0,1}},{{-1,-1,0,0,0},{0,0,0,-1,0},{0,0,-1,-1,-1},{1,0,0,1,0},{0,0,1,1,0}},{{-1,0,0,0,0},{0,0,0,-1,0},{0,-1,-1,-1,-1},{1,1,0,1,0},{0,0,1,1,0}},{{-1,-1,0,-1,0},{0,0,0,-1,0},{0,0,-1,0,-1},{1,0,0,1,0},{0,0,1,0,0}},{{-1,0,0,0,0},{0,1,0,0,0},{0,0,1,0,0},{-1,0,0,-1,0},{0,1,1,1,1}},{{-1,0,0,0,0},{0,1,0,0,0},{0,0,0,1,0},{-1,0,-1,0,0},{0,1,1,1,1}},{{-1,0,0,0,0},{1,1,0,0,0},{0,0,-1,0,0},{1,0,1,1,0},{-1,0,1,0,1}},{{-1,-1,0,0,0},{1,0,1,0,0},{0,0,-1,-1,-1},{0,0,-1,0,0},{0,0,0,1,0}},{{-1,0,0,0,0},{1,1,1,0,0},{0,-1,-1,-1,-1},{0,0,-1,0,0},{0,0,0,1,0}},{{-1,-1,0,0,0},{1,0,0,0,0},{0,0,-1,0,0},{1,1,1,1,0},{-1,0,1,0,1}},{{1,1,1,0,0},{-1,0,0,0,0},{0,-1,0,0,0},{0,0,0,1,0},{1,1,1,0,1}},{{1,0,0,0,0},{0,1,0,0,0},{-1,0,-1,0,0},{0,0,1,1,0},{1,0,1,0,1}},{{-1,0,0,0,0},{0,-1,0,0,0},{0,0,-1,0,0},{1,0,1,1,0},{0,1,1,0,1}},{{-1,-1,0,0,0},{1,0,1,0,0},{0,1,0,-1,0},{0,0,-1,0,0},{0,0,1,1,1}},{{-1,0,0,0,0},{1,1,1,0,0},{0,0,0,-1,0},{0,0,-1,0,0},{0,0,1,1,1}},{{1,0,0,0,0},{0,1,1,0,0},{-1,-1,-1,-1,-1},{-1,0,-1,0,0},{1,0,0,1,0}},{{1,0,1,0,0},{0,0,0,1,0},{0,0,-1,0,0},{0,1,0,0,0},{0,0,1,0,1}},{{-1,0,-1,0,0},{0,0,-1,0,0},{1,1,1,0,0},{1,0,1,1,0},{-1,0,0,0,1}},{{-1,-1,-1,0,0},{0,0,-1,0,0},{0,0,0,-1,-1},{1,0,1,0,0},{0,0,0,1,0}},{{-1,0,0,0,0},{1,1,1,0,0},{0,-1,-1,-1,-1},{0,0,-1,0,0},{0,0,1,1,0}},{{-1,-1,0,0,0},{1,0,1,0,0},{0,0,-1,-1,-1},{0,0,-1,0,0},{0,0,1,1,0}},{{-1,0,0,0,0},{-1,-1,0,0,0},{0,0,1,0,0},{0,0,1,1,0},{-1,0,1,0,1}},{{1,0,0,0,0},{0,-1,0,0,0},{1,0,0,1,0},{0,-1,-1,0,0},{1,0,1,1,1}},{{1,0,0,0,0},{0,1,0,0,0},{0,0,1,0,0},{1,0,0,1,0},{-1,0,0,0,1}},{{1,1,0,0,0},{-1,0,0,0,0},{0,-1,1,0,0},{1,0,0,1,0},{0,1,0,0,1}},{{1,0,0,0,0},{-1,-1,0,0,0},{0,0,1,0,0},{1,1,0,1,0},{0,0,0,0,1}},{{1,1,0,0,0},{-1,0,0,0,0},{0,0,1,0,0},{1,0,0,1,0},{0,0,0,0,1}},{{-1,0,0,0,0},{2,1,1,1,0},{0,-1,0,0,0},{0,0,0,-1,0},{-1,0,0,0,1}},{{-2,-1,-1,-1,0},{1,0,0,0,0},{1,1,0,0,0},{0,0,1,0,0},{-1,0,0,0,1}},{{1,0,0,0,0},{1,1,0,1,0},{-1,-1,-1,0,-1},{-1,0,0,-1,0},{1,0,1,0,0}},{{1,1,1,1,0},{1,0,0,0,0},{-1,0,-1,-1,0},{-1,-1,0,-1,0},{0,1,1,1,1}},{{1,0,0,0,0},{1,1,1,1,0},{-1,-1,0,0,0},{-1,0,0,-1,0},{0,0,0,0,1}},{{-1,-1,0,0,0},{0,0,0,0,1},{-1,0,-1,-1,0},{1,0,0,0,-1},{0,0,1,0,0}},{{-1,0,0,0,0},{0,1,0,0,1},{-1,-1,-1,-1,0},{1,0,0,0,-1},{0,0,1,0,0}},{{1,0,0,0,0},{-1,0,0,-1,0},{0,1,0,0,0},{1,0,1,1,0},{0,0,0,0,1}},{{-2,-1,-1,-1,0},{1,0,0,0,0},{0,1,0,0,0},{1,0,1,0,0},{-1,0,0,0,1}},{{1,0,0,0,0},{0,1,0,0,1},{-2,-1,-1,-1,0},{0,0,0,0,-1},{1,0,1,0,0}},{{1,1,1,0,0},{-1,0,0,0,0},{0,-1,0,0,0},{1,0,0,1,0},{0,1,0,0,1}},{{1,0,0,0,0},{0,1,0,0,0},{-1,0,-1,0,0},{1,0,1,1,0},{0,0,0,0,1}},{{1,1,0,0,0},{-1,0,0,0,0},{-1,-1,-1,0,0},{1,0,1,1,0},{0,1,0,0,1}},{{-1,0,0,0,0},{1,1,0,0,0},{1,0,1,0,0},{1,0,0,1,0},{-2,0,0,0,1}},{{-1,-1,0,0,0},{1,0,0,0,0},{1,1,1,0,0},{1,1,0,1,0},{-2,-1,0,0,1}},{{2,1,1,0,0},{-1,0,0,0,0},{-1,-1,0,0,0},{0,0,-1,1,0},{1,1,1,0,1}},{{1,0,0,0,0},{1,1,0,0,0},{0,0,1,0,0},{0,0,0,1,0},{-1,0,0,0,1}},{{-1,0,0,0,0},{1,1,0,0,0},{1,0,1,0,0},{1,0,0,1,0},{-1,0,0,0,1}},{{-1,0,0,0,0},{0,-1,0,0,0},{0,0,-1,0,0},{2,1,1,1,0},{-1,0,0,0,1}},{{1,1,0,0,0},{-1,0,0,0,0},{1,0,1,0,0},{0,0,0,1,0},{0,0,0,0,1}},{{1,0,0,0,0},{-1,-1,0,0,0},{1,1,1,0,0},{0,0,0,1,0},{0,0,0,0,1}},{{1,0,0,0,0},{-1,-1,0,0,0},{-1,0,-1,0,0},{1,1,1,1,0},{0,0,0,0,1}},{{1,0,0,0,0},{1,1,1,0,0},{-1,-1,0,-1,-1},{-1,0,-1,0,0},{1,0,0,1,0}},{{2,1,1,0,0},{-1,0,0,0,0},{-1,-1,0,0,0},{0,0,0,1,0},{1,1,0,0,1}},{{1,0,0,0,0},{0,1,0,0,0},{1,0,1,0,0},{0,0,0,1,0},{-1,0,0,0,1}},{{1,1,0,0,0},{-1,0,0,0,0},{1,0,1,0,0},{0,-1,0,1,0},{0,1,0,0,1}},{{0,1,0,0,0},{-1,0,-1,0,0},{1,1,0,1,0},{0,1,0,1,1},{0,1,-1,0,0}},{{-1,-1,0,0,0},{0,-1,0,0,0},{-1,-1,-1,0,0},{0,-1,0,1,0},{-1,-1,0,0,1}},{{0,0,-1,0,0},{-1,0,-1,0,0},{-1,-1,-1,0,0},{0,0,-1,1,0},{-1,0,-1,0,1}},{{1,0,1,1,0},{-1,0,0,0,0},{-1,-1,-1,-1,0},{0,0,0,-1,0},{1,1,1,1,1}},{{-1,0,0,0,0},{1,1,0,1,0},{0,-1,-1,0,-1},{0,0,0,-1,0},{0,0,1,0,0}},{{-1,-1,0,0,0},{1,0,0,1,0},{0,0,-1,0,-1},{0,0,0,-1,0},{0,0,1,0,0}},{{-1,0,0,0,0},{0,0,0,-1,0},{1,1,0,0,0},{1,0,1,1,0},{-1,0,0,0,1}},{{1,1,0,0,0},{0,1,0,0,0},{0,0,-1,0,0},{1,1,0,1,0},{0,1,0,0,1}},{{-1,0,0,0,0},{1,1,1,1,0},{0,-1,0,0,0},{0,0,0,-1,0},{-1,0,0,0,1}},{{-1,0,0,0,0},{1,1,0,1,0},{0,-1,-1,0,0},{0,0,0,-1,0},{-1,0,1,0,1}},{{-1,-1,0,0,0},{1,0,0,1,0},{0,0,-1,0,0},{0,0,0,-1,0},{-1,0,1,0,1}},{{1,1,0,0,0},{0,-1,0,1,0},{0,0,-1,0,-1},{-1,-1,0,-1,0},{1,1,1,0,0}},{{1,1,0,1,0},{0,0,-1,0,-1},{0,0,0,-1,0},{-1,0,0,0,1},{0,-1,0,0,0}},{{1,0,0,0,0},{-1,-1,0,-1,0},{0,1,0,0,0},{0,0,1,1,0},{0,0,0,0,1}},{{0,1,0,-1,0},{-1,-1,0,0,0},{0,0,-1,0,0},{0,-1,0,0,0},{0,1,1,0,1}},{{1,1,0,0,0},{-1,-1,0,0,1},{-1,0,-1,-1,0},{0,-1,0,0,-1},{1,1,1,0,0}},{{-1,-1,0,0,0},{0,0,0,0,1},{0,0,-1,0,0},{1,0,0,0,-1},{0,0,1,1,0}},{{0,0,0,0,1},{0,0,1,0,0},{1,0,0,0,-1},{0,1,0,0,0},{0,0,0,1,0}},{{-1,-1,0,0,0},{0,0,0,0,1},{0,1,-1,0,0},{1,0,0,0,-1},{0,0,1,1,0}},{{1,0,1,0,0},{-1,0,-1,0,1},{-1,-1,0,-1,0},{0,0,-1,0,-1},{1,1,1,0,0}},{{-1,-1,-1,0,0},{0,0,0,0,1},{0,0,1,-1,0},{1,0,0,0,-1},{-1,0,-1,0,0}},{{1,0,0,1,0},{-1,0,0,-1,1},{-1,-1,-1,0,0},{0,0,0,-1,-1},{1,1,0,1,0}},{{-1,-1,-1,0,0},{1,0,0,1,0},{1,0,1,0,-1},{0,0,0,-1,0},{-1,0,-1,0,0}},{{-1,0,0,0,0},{0,1,0,0,1},{0,-1,-1,0,0},{1,0,0,0,-1},{0,0,1,1,0}},{{0,1,0,0,1},{-1,0,-1,-1,0},{1,0,0,0,-1},{0,0,0,1,0},{0,-1,0,0,0}},{{1,0,1,0,0},{0,0,-1,1,0},{0,-1,0,0,-1},{-1,0,-1,-1,0},{1,1,1,0,0}},{{-1,-1,0,-1,0},{1,0,1,0,0},{1,0,0,1,-1},{0,0,-1,0,0},{-1,0,0,-1,0}},{{-1,0,0,0,0},{0,1,0,0,1},{0,0,-1,0,0},{1,0,0,0,-1},{0,0,1,1,0}},{{1,0,0,0,0},{-1,1,0,0,1},{-1,-1,-1,-1,0},{0,0,0,0,-1},{1,0,1,0,0}},{{1,0,1,0,0},{0,0,1,0,0},{0,-1,0,0,0},{1,0,1,1,0},{0,0,1,0,1}},{{1,1,1,0,0},{0,0,1,0,0},{0,1,0,0,0},{1,1,1,1,0},{0,1,1,0,1}},{{0,1,0,0,0},{0,0,1,0,0},{1,1,1,1,0},{1,1,1,0,0},{0,1,1,1,1}},{{-1,0,0,0,0},{0,-1,0,0,0},{0,0,-1,0,0},{1,1,1,1,0},{-1,0,0,0,1}},{{-1,0,0,0,0},{1,1,1,0,0},{0,-1,0,-1,0},{0,0,-1,0,0},{-1,0,0,1,1}},{{-1,-1,0,0,0},{1,0,1,0,0},{0,0,0,-1,0},{0,0,-1,0,0},{-1,0,0,1,1}},{{1,1,0,0,0},{0,-1,1,0,0},{0,0,0,-1,-1},{-1,-1,-1,0,0},{1,1,0,1,0}},{{-1,0,-1,0,0},{1,1,0,0,0},{0,0,0,-1,0},{0,-1,0,0,0},{-1,0,0,1,1}},{{1,0,0,0,0},{0,1,0,0,0},{-1,-1,-1,0,0},{0,0,1,1,0},{0,0,0,0,1}},{{1,1,1,0,0},{0,0,0,-1,-1},{0,0,-1,0,0},{-1,0,0,0,1},{0,-1,0,0,0}},{{-1,0,0,0,0},{1,1,1,0,0},{0,0,0,-1,0},{0,0,-1,0,0},{-1,0,0,1,1}},{{-1,-1,0,0,0},{1,0,1,0,0},{0,1,0,-1,0},{0,0,-1,0,0},{-1,0,0,1,1}},{{-1,0,0,0,0},{0,-1,0,0,0},{0,0,-1,0,0},{1,0,1,1,0},{-1,1,0,0,1}},{{1,0,0,0,0},{0,1,0,0,0},{-1,0,-1,0,0},{0,0,1,1,0},{0,0,0,0,1}},{{1,0,1,0,0},{0,0,0,1,0},{0,0,-1,0,0},{0,1,0,0,0},{-1,0,0,0,1}},{{1,0,0,0,0},{0,1,1,0,0},{0,-1,0,-1,-1},{-1,0,-1,0,0},{1,0,0,1,0}},{{1,1,1,0,0},{-1,0,0,0,0},{0,-1,0,0,0},{0,0,0,1,0},{0,1,0,0,1}},{{1,0,0,0,0},{0,-1,0,0,0},{0,0,0,-1,0},{1,0,1,0,0},{0,0,0,0,1}},{{0,1,0,0,0},{0,0,1,0,0},{0,0,0,1,0},{-1,0,0,0,0},{0,1,1,1,1}},{{-1,0,0,0,0},{0,0,1,0,0},{-1,-1,0,-1,0},{-1,-1,0,0,0},{-1,0,1,0,1}},{{1,1,0,0,0},{-1,0,0,0,0},{0,0,1,0,0},{0,0,0,1,0},{0,0,0,0,1}},{{1,0,0,0,0},{-1,-1,0,0,0},{0,0,1,0,0},{0,1,0,1,0},{0,0,0,0,1}},{{-1,0,0,0,0},{0,-1,0,0,0},{0,0,-1,0,0},{1,1,0,1,0},{-1,0,1,0,1}},{{-1,0,-1,0,0},{1,1,0,0,0},{0,0,1,-1,0},{0,-1,0,0,0},{-1,0,0,1,1}},{{1,0,0,0,0},{0,1,0,0,0},{-1,-1,-1,0,0},{0,0,0,1,0},{0,0,1,0,1}},{{1,0,0,0,0},{-1,-1,0,0,0},{0,1,1,0,0},{0,0,0,1,0},{0,0,0,0,1}},{{1,1,0,0,0},{0,0,0,1,0},{0,-1,0,0,0},{0,0,1,0,0},{-1,0,0,0,1}},{{1,0,0,0,0},{-1,-1,0,0,0},{0,0,1,0,0},{0,0,0,1,0},{0,1,0,0,1}},{{1,1,0,0,0},{-1,0,0,0,0},{0,0,1,0,0},{0,-1,0,1,0},{0,1,0,0,1}},{{-1,0,0,0,0},{0,-1,0,0,0},{0,0,-1,0,0},{1,0,0,1,0},{-1,1,1,0,1}},{{1,1,1,0,0},{-1,0,0,0,0},{0,-1,0,0,0},{0,0,-1,1,0},{0,1,1,0,1}},{{1,0,0,0,0},{0,1,0,0,0},{0,0,1,0,0},{0,0,0,1,0},{-1,0,0,0,1}},{{1,1,0,0,0},{-1,0,0,0,0},{0,-1,1,0,0},{0,0,0,1,0},{0,1,0,0,1}},{{1,0,0,0,0},{0,1,0,0,0},{-1,0,-1,0,0},{0,0,0,1,0},{0,0,1,0,1}},{{-1,0,0,0,0},{1,1,0,1,0},{0,0,-1,0,0},{0,0,0,-1,0},{-1,0,1,0,1}},{{1,0,0,0,0},{0,1,0,1,0},{0,-1,-1,0,-1},{-1,0,0,-1,0},{1,0,1,0,0}},{{1,0,0,1,0},{0,0,1,0,0},{0,0,0,-1,0},{0,1,0,0,0},{-1,0,0,0,1}},{{-1,-1,0,0,0},{1,0,0,1,0},{0,1,-1,0,0},{0,0,0,-1,0},{-1,0,1,0,1}},{{-1,0,0,0,0},{1,0,1,1,0},{0,-1,0,0,0},{0,0,0,-1,0},{-1,1,0,0,1}},{{1,0,0,0,0},{-1,0,0,-1,0},{0,1,0,0,0},{0,0,1,1,0},{0,0,0,0,1}},{{-1,-1,-1,-1,0},{1,0,0,0,0},{0,1,0,0,0},{0,0,1,0,0},{-1,0,0,0,1}},{{1,0,0,0,0},{0,-1,0,0,0},{0,0,-1,0,0},{1,0,0,1,0},{0,0,0,0,1}},{{-1,0,-1,0,0},{1,0,0,0,0},{0,1,0,0,0},{1,0,1,1,0},{-1,0,0,0,1}},{{-1,0,0,0,0},{0,-1,0,0,0},{1,0,1,0,0},{1,0,0,1,0},{-1,1,0,0,1}},{{-1,-1,-1,0,0},{1,0,0,0,0},{0,1,0,0,0},{1,0,1,1,0},{-1,0,0,0,1}},{{-1,0,0,0,0},{0,1,0,0,0},{1,0,1,0,0},{1,0,0,1,0},{-1,0,0,0,1}},{{-1,-1,0,0,0},{1,0,0,0,0},{0,0,-1,0,0},{1,1,1,1,0},{-1,0,0,0,1}},{{-1,0,0,0,0},{1,1,0,0,0},{0,0,-1,0,0},{1,0,1,1,0},{-1,0,0,0,1}},{{-1,-1,0,0,0},{1,0,1,0,0},{0,0,0,-1,-1},{0,0,-1,0,0},{0,0,0,1,0}},{{-1,0,0,0,0},{1,1,1,0,0},{0,-1,0,-1,-1},{0,0,-1,0,0},{0,0,0,1,0}},{{1,1,0,0,0},{-1,0,0,0,0},{-1,-1,-1,0,0},{0,0,0,1,0},{1,1,1,0,1}},{{1,0,0,0,0},{-1,-1,0,0,0},{-1,0,-1,0,0},{0,0,0,1,0},{1,1,1,0,1}},{{-1,-1,0,0,0},{1,0,0,0,0},{1,1,1,0,0},{0,0,0,1,0},{-1,0,0,0,1}},{{-1,0,0,0,0},{0,-1,0,0,0},{1,1,1,0,0},{1,0,0,1,0},{-1,0,0,0,1}},{{1,1,0,1,0},{-1,-1,0,0,0},{-1,0,-1,-1,0},{0,-1,0,0,0},{1,1,1,1,1}},{{-1,0,0,0,0},{0,-1,0,0,0},{1,0,1,0,0},{1,1,0,1,0},{-1,0,0,0,1}},{{-1,-1,0,0,0},{1,0,0,0,0},{0,0,1,0,0},{1,1,0,1,0},{-1,0,0,0,1}},{{-1,0,0,0,0},{1,1,0,0,0},{0,0,-1,0,0},{1,0,0,1,0},{-1,0,1,0,1}},{{-1,-1,0,0,0},{1,0,0,0,0},{0,0,-1,0,0},{1,1,0,1,0},{-1,0,1,0,1}},{{-1,0,0,0,0},{1,1,0,0,0},{0,0,1,0,0},{1,0,0,1,0},{-1,0,0,0,1}},{{-1,-1,-1,0,0},{1,0,0,0,0},{0,1,0,0,0},{1,1,1,1,0},{-1,-1,0,0,1}},{{-1,0,0,0,0},{1,1,0,0,0},{1,0,1,0,0},{0,0,0,1,0},{-1,0,0,0,1}}};

// All neighbors of the perfect form 1 are of type 0
const small neigh_vertex1[symdim] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0}; 
/*const small neigh_chg1[symdim][ndim*ndim] = {
{1,1,0,0,0,-1,0,0,0,0,0,0,1,0,0,0,0,0,1,0,1,1,0,0,1},{-1,-1,-1,-1,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,1},{-1,-1,-1,-1,-1,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,-1,-1,-1,0,-1},{1,1,1,0,0,-1,0,0,0,0,0,-1,0,0,0,0,0,0,1,0,1,1,1,0,1},{1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,1,0,0,0,1},{-1,-1,-1,-1,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,0,1},{1,0,0,0,0,0,1,0,0,0,-1,0,1,0,0,0,0,0,1,0,1,0,0,0,1},{1,1,0,0,0,-1,0,0,0,0,0,0,1,0,0,0,0,0,1,0,1,0,0,0,1},{1,1,1,0,0,-1,0,0,0,0,0,-1,0,0,0,0,0,-1,1,0,1,1,1,0,1},{1,0,0,0,0,-1,1,0,0,0,0,0,1,0,0,0,0,0,1,0,1,0,0,0,1},{1,1,1,0,0,-1,0,0,0,0,0,-1,0,0,0,0,0,0,1,0,1,1,0,0,1},{1,1,0,0,0,-1,0,0,0,0,0,0,1,0,0,0,-1,0,1,0,1,1,0,0,1},{1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1},{1,1,0,0,0,-1,0,0,0,0,0,-1,1,0,0,0,0,0,1,0,1,1,0,0,1},{1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,-1,0,0,1,0,1,0,0,0,1}
};*/
const small neigh_chg1[symdim][ndim][ndim] = {{{1,1,0,0,0},{-1,0,0,0,0},{0,0,1,0,0},{0,0,0,1,0},{1,1,0,0,1}},{{-1,-1,-1,-1,0},{1,0,0,0,0},{0,1,0,0,0},{0,0,1,0,0},{0,0,0,1,1}},{{-1,-1,-1,-1,-1},{1,0,0,0,0},{0,1,0,0,0},{0,0,1,0,0},{-1,-1,-1,0,-1}},{{1,1,1,0,0},{-1,0,0,0,0},{0,-1,0,0,0},{0,0,0,1,0},{1,1,1,0,1}},{{1,0,0,0,0},{0,1,0,0,0},{0,0,1,0,0},{0,0,0,1,0},{1,0,0,0,1}},{{-1,-1,-1,-1,0},{1,0,0,0,0},{0,1,0,0,0},{0,0,1,0,0},{0,0,0,0,1}},{{1,0,0,0,0},{0,1,0,0,0},{-1,0,1,0,0},{0,0,0,1,0},{1,0,0,0,1}},{{1,1,0,0,0},{-1,0,0,0,0},{0,0,1,0,0},{0,0,0,1,0},{1,0,0,0,1}},{{1,1,1,0,0},{-1,0,0,0,0},{0,-1,0,0,0},{0,0,-1,1,0},{1,1,1,0,1}},{{1,0,0,0,0},{-1,1,0,0,0},{0,0,1,0,0},{0,0,0,1,0},{1,0,0,0,1}},{{1,1,1,0,0},{-1,0,0,0,0},{0,-1,0,0,0},{0,0,0,1,0},{1,1,0,0,1}},{{1,1,0,0,0},{-1,0,0,0,0},{0,0,1,0,0},{0,-1,0,1,0},{1,1,0,0,1}},{{1,0,0,0,0},{0,1,0,0,0},{0,0,1,0,0},{0,0,0,1,0},{0,0,0,0,1}},{{1,1,0,0,0},{-1,0,0,0,0},{0,-1,1,0,0},{0,0,0,1,0},{1,1,0,0,1}},{{1,0,0,0,0},{0,1,0,0,0},{0,0,1,0,0},{-1,0,0,1,0},{1,0,0,0,1}}};
const small neigh_vertex2[symdim] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0}; 
/*const small neigh_chg2[symdim][ndim*ndim]const small neigh_chg2[symdim][ndim*ndim] =  = {
{0,0,0,-1,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,-1,-1,-1,0,1},{0,-1,0,0,0,1,0,0,0,0,0,1,-1,0,0,-1,0,0,1,0,-1,-1,0,0,1},{1,0,0,0,0,-1,0,0,0,1,0,0,0,-1,0,0,1,0,0,-1,1,0,1,0,-1},{-1,0,0,0,0,0,1,0,0,0,1,0,-1,0,0,0,-1,0,1,0,-1,-1,0,0,1},{1,0,0,0,0,-1,0,0,1,0,0,0,0,0,-1,0,1,0,-1,0,1,0,1,-1,0},{-1,0,0,0,0,1,-1,0,0,0,0,0,1,0,0,0,0,-1,1,0,-1,0,-1,0,1},{0,1,0,0,0,-1,0,0,0,0,0,0,-1,0,0,0,-1,0,1,0,0,0,0,0,1},{1,0,0,0,0,-1,0,0,1,0,0,-1,0,0,0,0,0,1,-1,0,0,0,-1,0,1},{-1,0,0,0,0,1,0,1,-1,0,0,1,0,0,0,0,-1,0,1,0,-1,0,-1,0,1},{1,0,0,0,0,-1,0,0,1,0,0,0,-1,0,0,0,1,0,-1,0,0,-1,0,0,1},{0,0,1,0,0,-1,0,0,0,0,0,-1,0,0,0,0,0,-1,1,0,0,0,0,0,1},{1,0,0,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1,0,-1,0,1,0},{-1,0,0,1,0,1,0,0,0,0,0,1,0,-1,0,0,0,1,-1,0,-1,-1,-1,1,1},{0,-1,0,1,0,-1,0,0,0,0,1,0,0,-1,0,0,1,1,-1,0,0,-1,-1,1,1},{1,0,0,0,0,0,-1,0,0,0,0,0,-1,0,0,-1,0,0,1,0,0,0,0,0,1}
};*/
const small neigh_chg2[symdim][ndim][ndim] = {{{0,0,0,-1,0},{1,0,0,0,0},{0,1,0,0,0},{0,0,1,0,0},{-1,-1,-1,0,1}},{{0,-1,0,0,0},{1,0,0,0,0},{0,1,-1,0,0},{-1,0,0,1,0},{-1,-1,0,0,1}},{{1,0,0,0,0},{-1,0,0,0,1},{0,0,0,-1,0},{0,1,0,0,-1},{1,0,1,0,-1}},{{-1,0,0,0,0},{0,1,0,0,0},{1,0,-1,0,0},{0,-1,0,1,0},{-1,-1,0,0,1}},{{1,0,0,0,0},{-1,0,0,1,0},{0,0,0,0,-1},{0,1,0,-1,0},{1,0,1,-1,0}},{{-1,0,0,0,0},{1,-1,0,0,0},{0,0,1,0,0},{0,0,-1,1,0},{-1,0,-1,0,1}},{{0,1,0,0,0},{-1,0,0,0,0},{0,0,-1,0,0},{0,-1,0,1,0},{0,0,0,0,1}},{{1,0,0,0,0},{-1,0,0,1,0},{0,-1,0,0,0},{0,0,1,-1,0},{0,0,-1,0,1}},{{-1,0,0,0,0},{1,0,1,-1,0},{0,1,0,0,0},{0,-1,0,1,0},{-1,0,-1,0,1}},{{1,0,0,0,0},{-1,0,0,1,0},{0,0,-1,0,0},{0,1,0,-1,0},{0,-1,0,0,1}},{{0,0,1,0,0},{-1,0,0,0,0},{0,-1,0,0,0},{0,0,-1,1,0},{0,0,0,0,1}},{{1,0,0,0,0},{-1,0,0,0,1},{0,0,-1,0,0},{0,1,0,0,-1},{0,-1,0,1,0}},{{-1,0,0,1,0},{1,0,0,0,0},{0,1,0,-1,0},{0,0,1,-1,0},{-1,-1,-1,1,1}},{{0,-1,0,1,0},{-1,0,0,0,0},{1,0,0,-1,0},{0,1,1,-1,0},{0,-1,-1,1,1}},{{1,0,0,0,0},{0,-1,0,0,0},{0,0,-1,0,0},{-1,0,0,1,0},{0,0,0,0,1}}};


// This data enumerates the differences between the successive neighbors.
const uchar iw0[866] = {64,163,128,66,113,130,161,65,113,130,162,67,128,115,131,18,34,66,114,129,161,178,18,34,65,114,130,161,177,67,112,64,163,179,115,128,112,67,131,115,16,160,112,64,115,18,33,66,97,113,177,194,210,226,49,98,17,33,65,98,130,146,17,50,18,97,113,129,145,177,194,209,226,112,17,49,65,115,178,193,210,225,50,66,97,113,18,49,114,129,50,98,130,177,193,210,226,64,48,195,67,96,179,51,176,112,48,115,160,16,179,99,208,19,176,128,163,179,131,16,211,51,208,112,115,160,192,19,176,128,163,179,131,16,211,64,67,96,160,19,176,128,163,179,131,16,195,19,99,163,17,50,66,82,130,160,177,193,209,225,18,97,50,66,82,97,129,178,194,210,226,48,195,131,99,176,64,16,179,67,19,208,128,51,192,131,16,64,211,19,176,67,163,179,195,19,35,192,208,224,67,115,128,112,64,115,3,19,80,99,192,16,48,160,64,51,192,67,96,195,112,19,176,115,99,192,64,48,195,67,51,208,112,16,179,32,83,176,195,96,211,131,64,99,176,51,192,67,96,179,128,99,208,131,16,211,64,48,195,67,19,51,163,0,16,48,147,211,64,115,131,112,67,115,160,179,227,48,195,128,96,211,131,51,99,163,96,160,192,128,19,35,48,80,115,99,208,16,179,112,96,211,115,19,99,163,51,67,83,131,195,3,19,51,99,176,192,208,224,96,112,128,144,208,160,176,192,64,16,179,67,48,195,19,176,64,16,32,99,147,131,51,192,128,96,211,131,99,163,195,48,96,160,0,35,163,179,115,128,67,131,112,128,96,144,160,227,163,179,195,48,160,176,64,16,179,67,51,192,64,19,48,80,128,163,160,176,208,112,96,211,99,115,192,64,48,195,16,179,67,51,208,112,96,211,115,99,192,64,32,147,176,211,131,16,195,112,19,176,115,48,179,128,99,208,51,192,131,16,112,195,19,176,115,163,179,211,19,35,192,208,224,115,128,112,67,115,131,3,51,160,19,99,163,96,160,176,112,99,208,115,16,179,112,32,64,163,176,211,48,96,160,128,99,208,131,51,176,112,16,179,115,19,192,128,96,211,16,131,195,112,19,176,1,17,49,66,82,97,114,129,145,179,194,209,1,17,178,226,18,34,49,81,50,82,97,145,2,98,209,225,81,146,193,210,1,82,162,194,17,33,177,18,34,49,81,178,193,50,82,97,145,194,209,2,81,98,129,161,193,209,193,210,33,65,130,146,177,210,177,194,1,17,49,97,113,130,146,178,210,128,115,131,99,163,128,64,112,131,67,128,160,208,131,115,128,65,97,113,130,145,162,210,50,67,82,97,112,145,194,209,49,65,82,114,130,161,194,128,67,131,51,163,64,112,128,67,115,64,160,192,67,131,64,2,18,49,66,81,98,129,194,209,177,210,2,17,49,65,81,98,129,178,193,64,19,176,67,51,208,48,179,128,16,131,160,19,176,51,192,16,179,112,163,195,115,19,192,16,211,64,67,96,160,48,195,19,176,128,163,179,131,51,99,163,160,176,192,96,195,112,115,160,192,128,163,179,131,16,195,112,1,18,49,65,98,115,177,193,66,113,194,209,114,129,178,193,1,17,49,97,130,194,209,128,112,131,49,114,161,177,210,49,114,161,177,209,128,112,64,115,131,112,51,192,67,115,64,128,67,112,16,179,131,64,128,115,131,67,18,129,162,194,210,18,65,113,177,97,114,130,210,66,97,161,177,193,128,64,112,131,67,128,16,179,64,131,115,128,67,131,18,98,113,162,194,49,65,129,194,18,66,114,177,49,97,130,161,177,64,128,112,67,131,64,16,179,67,128,115,131,64,128,99,208,67,112,64,131,67,115,18,50,65,162,210,17,50,65,162,210,112,67,115,19,192,64,128,67,96,195,112,131,99,176,64,115,48,179,128,67,131,51,176,96,179};
const uchar stop0[109] = {70,124,32,240,254,30,160,160,0,3,34,2,91,83,101,77,217,148,37,128,2,180,109,211,132,63,100,217,182,69,211,182,77,248,211,38,99,109,66,64,200,214,216,38,241,71,178,13,89,214,182,177,109,77,19,254,36,219,144,109,91,22,0,17,17,17,9,130,64,65,1,222,223,3,1,129,247,247,0,5,216,154,42,107,42,147,38,27,16,17,120,8,127,127,127,136,8,127,127,136,8,127,127,127,8,239,221,189,2};
const uchar iw1[61] = {19,35,67,115,179,16,32,64,99,131,147,176,211,96,112,128,144,163,179,195,227,51,67,83,131,160,176,208,224,3,19,64,80,99,128,163,192,0,16,48,96,160,208,48,211,51,176,128,179,16,131,19,192,112,195,115,160,64,163,67,96};
const uchar stop1 [8]= {16,16,16,16,16,84,85,21};
const uchar iw2[57] = {18,50,66,209,3,64,96,160,211,0,67,99,176,192,227,35,48,112,163,195,224,32,51,96,128,147,179,16,83,99,115,144,192,64,80,131,195,115,208,112,179,19,48,131,176,128,211,195,208,16,67,99,192,96,163,160,211};
const uchar stop2[8] = {8,65,16,4,81,81,81,1};

const small * neigh_vertex_[3] = {neigh_vertex0,neigh_vertex1,neigh_vertex2};
typedef const small (*arr_smallMatT)[ndim][ndim]; 
const arr_smallMatT neigh_chg_[3] = {neigh_chg0,neigh_chg1,neigh_chg2};
const int iwlen_[3]={866,61,57};
const uchar * iw_[3]   = {iw0,iw1,iw2};
const uchar * stop_[3] = {stop0,stop1,stop2};

const small coef0[symdim][symdim] = {{1,1,0,1,0,0,1,0,0,0,0,0,0,0,0},{0,1,1,0,1,0,0,1,0,0,0,1,0,0,0},{0,0,0,1,1,1,0,0,1,0,0,0,1,0,0},{0,0,0,0,0,0,1,1,1,1,1,0,0,1,0},{0,0,0,0,0,0,0,0,0,0,0,1,1,1,1},{0,0,0,0,0,0,-1,0,0,0,-1,0,0,0,0},{0,0,0,-1,0,0,0,0,0,0,0,0,0,0,0},{0,-1,0,0,0,0,0,0,0,0,0,0,0,0,0},{0,0,0,0,0,0,0,0,0,0,0,-1,0,0,0},{0,0,0,0,0,0,0,-1,0,0,0,0,0,0,0},{0,0,0,0,-1,0,0,0,0,0,0,0,0,0,0},{0,0,0,0,0,0,0,0,0,0,0,0,-1,0,0},{0,0,0,0,0,0,0,0,-1,0,0,0,0,0,0},{0,0,0,0,0,0,0,0,0,0,-1,0,0,-1,0},{0,0,0,0,0,0,0,0,0,0,1,0,0,0,0}};

const small support0[kktdim][ndim] = {
	{1,0,0,0,0},{0,1,0,0,0},{0,0,1,0,0},{0,0,0,1,0},{0,0,0,0,1},
	{1,0,0,-1,0},{1,0,-1,0,0},{1,-1,0,0,0},{0,1,0,0,-1},{0,1,0,-1,0},
	{0,1,-1,0,0},{0,0,1,0,-1},{0,0,1,-1,0},{0,0,0,1,-1},{1,0,0,-1,1},
	{1,0,-1,0,1},{1,-1,0,0,1},{1,0,-1,-1,1},{1,-1,0,-1,1},{1,-1,-1,0,1}};

const small coef1[symdim][symdim] = {{1,1,0,1,0,0,1,0,0,0,1,0,0,0,0},{0,1,1,0,1,0,0,1,0,0,0,1,0,0,0},{0,0,0,1,1,1,0,0,1,0,0,0,1,0,0},{0,0,0,0,0,0,1,1,1,1,0,0,0,1,0},{0,0,0,0,0,0,0,0,0,0,1,1,1,1,1},{0,0,0,0,0,0,0,0,0,0,-1,0,0,0,0},{0,0,0,0,0,0,-1,0,0,0,0,0,0,0,0},{0,0,0,-1,0,0,0,0,0,0,0,0,0,0,0},{0,-1,0,0,0,0,0,0,0,0,0,0,0,0,0},{0,0,0,0,0,0,0,0,0,0,0,-1,0,0,0},{0,0,0,0,0,0,0,-1,0,0,0,0,0,0,0},{0,0,0,0,-1,0,0,0,0,0,0,0,0,0,0},{0,0,0,0,0,0,0,0,0,0,0,0,-1,0,0},{0,0,0,0,0,0,0,0,-1,0,0,0,0,0,0},{0,0,0,0,0,0,0,0,0,0,0,0,0,-1,0}};
const small support1[symdim][ndim] = {
	{1,0,0,0,0},{0,1,0,0,0},{0,0,1,0,0},{0,0,0,1,0},{0,0,0,0,1},
	{1,0,0,0,-1},{1,0,0,-1,0},{1,0,-1,0,0},{1,-1,0,0,0},{0,1,0,0,-1},
	{0,1,0,-1,0},{0,1,-1,0,0},{0,0,1,0,-1},{0,0,1,-1,0},{0,0,0,1,-1}
//	{0,0,0,0,0},{0,0,0,0,0},{0,0,0,0,0},{0,0,0,0,0},{0,0,0,0,0}
};

const small coef2[symdim][symdim] = {{2,1,0,1,-1,0,-2,0,0,0,-2,0,0,1,0},{0,1,2,-1,1,0,0,-2,0,0,0,-2,0,1,0},{0,-1,0,1,1,2,0,0,-2,0,0,0,-2,1,0},{0,1,0,1,1,0,-2,-2,-2,2,0,0,0,1,0},{0,1,0,1,1,0,0,0,0,0,-2,-2,-2,1,2},{0,-1,0,-1,1,0,2,0,0,0,0,0,0,-1,0},{0,-1,0,-1,1,0,0,0,0,0,2,0,0,-1,0},{0,-1,0,1,-1,0,0,2,0,0,0,0,0,-1,0},{0,-1,0,1,-1,0,0,0,0,0,0,2,0,-1,0},{0,1,0,-1,-1,0,0,0,2,0,0,0,0,-1,0},{0,1,0,-1,-1,0,0,0,0,0,0,0,2,-1,0},{0,1,0,-1,-1,0,0,0,0,0,0,0,0,1,0},{0,-1,0,1,-1,0,0,0,0,0,0,0,0,1,0},{0,-1,0,-1,1,0,0,0,0,0,0,0,0,1,0},{0,1,0,1,1,0,0,0,0,0,0,0,0,-1,0}};
/*  // Original (half the above)
const small coef2[symdim*symdim] = {
	1,0.5,0,0.5,-0.5,0,-1,0,0,0,-1,0,0,0.5,0,
	0,0.5,1,-0.5,0.5,0,0,-1,0,0,0,-1,0,0.5,0,
	0,-0.5,0,0.5,0.5,1,0,0,-1,0,0,0,-1,0.5,0,
	0,0.5,0,0.5,0.5,0,-1,-1,-1,1,0,0,0,0.5,0,
	0,0.5,0,0.5,0.5,0,0,0,0,0,-1,-1,-1,0.5,1,
	0,-0.5,0,-0.5,0.5,0,1,0,0,0,0,0,0,-0.5,0,
	0,-0.5,0,-0.5,0.5,0,0,0,0,0,1,0,0,-0.5,0,
	0,-0.5,0,0.5,-0.5,0,0,1,0,0,0,0,0,-0.5,0,
	0,-0.5,0,0.5,-0.5,0,0,0,0,0,0,1,0,-0.5,0,
	0,0.5,0,-0.5,-0.5,0,0,0,1,0,0,0,0,-0.5,0,
	0,0.5,0,-0.5,-0.5,0,0,0,0,0,0,0,1,-0.5,0,
	0,0.5,0,-0.5,-0.5,0,0,0,0,0,0,0,0,0.5,0,
	0,-0.5,0,0.5,-0.5,0,0,0,0,0,0,0,0,0.5,0,
	0,-0.5,0,-0.5,0.5,0,0,0,0,0,0,0,0,0.5,0,
	0,0.5,0,0.5,0.5,0,0,0,0,0,0,0,0,-0.5,0
};*/
const small support2[symdim][ndim] = {
	{1,0,0,0,0},{0,1,0,0,0},{0,0,1,0,0},{0,0,0,1,0},{0,0,0,0,1},
	{1,0,0,1,0},{1,0,0,0,1},{0,1,0,1,0},{0,1,0,0,1},{0,0,1,1,0},
	{0,0,1,0,1},{1,1,0,1,1},{1,0,1,1,1},{0,1,1,1,1},{1,1,1,1,1}
//	{0,0,0,0,0},{0,0,0,0,0},{0,0,0,0,0},{0,0,0,0,0},{0,0,0,0,0}
};
typedef const small (*coefT)[symdim]; // small[symdim][symdim]
const coefT coef_[3]={coef0,coef1,coef2};
typedef const small (*supportT)[ndim]; // small[kktdim or symdim][ndim]
const supportT support_[3] = {support0,support1,support2};

void KKT(const SimplexStateT & state, Scalar weights[symdim], OffsetT offsets[symdim][ndim]){
	if(debug_print && blockIdx.x==0 && threadIdx.x==0){
		printf("Entering KKT\n");
		for(Int i=0; i<symdim; ++i){printf("%f ",state.m[i]);} printf("\n");
		for(Int i=0; i<ndim; ++i){for(Int j=0; j<ndim; ++j){printf("%f ",state.a[i][j]);}} printf("\n");
		printf("state : %i ,",state.vertex);
		printf("obj : %f ",state.objective); printf("\n");
		printf("blockDim %i\n",blockDim.x);
	}


	const coefT coef       = coef_[state.vertex]; // coef[symdim][symdim]
	const supportT support = support_[state.vertex]; // support[kktdim][ndim]

	Scalar aInv_[ndim][ndim]; inv_a(state.a,aInv_);
	Int aInv[ndim][ndim]; round_a(aInv_,aInv); // The inverse is known to have integer entries

	// A bit of post processing is needed to get non-negative weights
	if(state.vertex>=1){
		dim_symdim::dot_av(coef,state.m,weights);
		for(int i=0; i<symdim; ++i){dot_av(aInv,support[i],offsets[i]);}
		if(state.vertex==2){dim_symdim::div_Vk(weights,2.);}
		return;
	}
	// vertex==0
	/* Call to a linear solver, to find positive weights.
	This implementation does not depend continuously on the decomposed matrix.
	A stable algorithm is proposed in the CPU HFM code.*/
	const int d = 5;
	const int max_size = 21;
	const int m = max_size;
	
	// TODO : many constraints appear several times.
	// (Only 5 distinct and non axis related.) Simplify ?
	Scalar halves[max_size][d+1] = {
		// Ask that the fifteen first multipliers be positive
		{0,0,1,1,1,0}, //0
		{0,1,0,0,0,0},
		{1,0,0,0,0,0},
		{-1,-1,-1,-1,-1,0},
		{0,0,1,1,1,0},
		{1,1,0,0,1,0}, //5
		{-1,0,-1,0,-1,0},
		{0,-1,0,-1,-1,0},
		{0,-1,0,-1,-1,0},
		{0,0,0,1,0,0},
		{0,0,0,0,1,0}, //10
		{-1,0,-1,0,-1,0},
		{0,0,1,0,0,0},
		{1,1,0,0,1,0},
		{-1,-1,-1,-1,-1,0},
		
		// last five must be positive as well
		{1,0,0,0,0,0},
		{0,1,0,0,0,0},
		{0,0,1,0,0,0},
		{0,0,0,1,0,0},
		{0,0,0,0,1,0},
		// projective component positive
		{0,0,0,0,0,1}
	};
	Scalar sol[kktdim];
	dim_symdim::dot_av(coef,state.m,sol); // Last 5 entries purposedly uninitialized
	Scalar maxSol = 0; 
	for(int i=0; i<symdim; ++i) maxSol = max(maxSol,abs(sol[i]));
	for(int i=0; i<symdim; ++i){halves[i][5] = sol[i]/maxSol;}
		
	// Minimize some arbitrary linear form (we only need a feasible solution)
	Scalar n_vec[d+1] = {1,1,1,1,1,0};
	Scalar d_vec[d+1] = {0,0,0,0,0,1};
		
	Scalar opt[d+1];
	Scalar work[((max_size+3)*(d+2)*(d-1))/2];
	
	const int BadIndex = 1234567890;
	int next[max_size] = {1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21};
	int prev[max_size] = {BadIndex,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19};
//	linprog(&halves[0][0], 0, m, n_vec, d_vec, d, opt, work, next, prev, max_size);  
	linprog(&halves[0][0], 0, m, n_vec, d_vec, d, opt, work, next, prev, max_size);  
	// TODO : check that status is correct
	// Get the solution, and find the non-zero weights, which should be positive.
	// kktdim - symdim = 5
	const Scalar linsol[5] = {opt[0]/opt[5],opt[1]/opt[5],opt[2]/opt[5],opt[3]/opt[5],opt[4]/opt[5]};
	for(int i=0; i<symdim; ++i){
		Scalar s=0; 
		for(int j=0; j<5; ++j) {s+=linsol[j]*halves[i][j];}
		s*=maxSol;
		sol[i]+=s;
	}
	for(int i=0; i<5; ++i){sol[15+i] = maxSol*linsol[i];}
	// We only need to exclude the 5 smallest elements. For simplicity, we sort all.
	Int ord[kktdim]; 
	fixed_length_sort<kktdim>(sol,ord);

	for(int i=0; i<symdim; ++i){
		const int j=ord[i+5]; 
		weights[i] = sol[j];
		dot_av(aInv,support[j],offsets[i]);
	} // for i
}

} // namespace Voronoi

const Int decompdim = symdim;
#include "Voronoi_.h"